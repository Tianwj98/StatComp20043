<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="20043" />

<meta name="date" content="2020-12-20" />

<title>Homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">20043</h4>
<h4 class="date">2020-12-20</h4>



<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce 3 examples in the book. The 1st example should contain texts and at least one figure. The 2nd example should contains texts and at least one table. The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>Example 1</p>
<p>使用R语言自带的数据集women（包含15个年龄在30~39岁间女性的身高和体重信息），作出身高和体重的散点图,并将体重作为预测变量，身高作为响应变量做简单线性回归，在图中作出回归线。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>fit&lt;-<span class="kw">lm</span>(weight<span class="op">~</span>height,<span class="dt">data=</span>women)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">plot</span>(women<span class="op">$</span>height,women<span class="op">$</span>weight,<span class="dt">xlab=</span><span class="st">&quot;Height&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Weight&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">abline</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Example 2</p>
<p>作出上面用到的数据集women身高和体重的表格</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(women))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">height</th>
<th align="right">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">58</td>
<td align="right">115</td>
</tr>
<tr class="even">
<td align="right">59</td>
<td align="right">117</td>
</tr>
<tr class="odd">
<td align="right">60</td>
<td align="right">120</td>
</tr>
<tr class="even">
<td align="right">61</td>
<td align="right">123</td>
</tr>
<tr class="odd">
<td align="right">62</td>
<td align="right">126</td>
</tr>
<tr class="even">
<td align="right">63</td>
<td align="right">129</td>
</tr>
</tbody>
</table>
<p>Example 3</p>
<p>公式： <span class="math display">\[\sum_{i=0}^{n}{(x_i)}\\\]</span> <span class="math display">\[\int_{a}^{b}{sinx}dx\]</span> <span class="math display">\[\lim_{x\to0}\frac{sinx}{x}\\\]</span></p>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>The Pareto(a, b) distribution has cdf <span class="math display">\[F(x)=1-(\frac{b}{x})^a ,x\ge b &gt; 0, a &gt; 0.\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<p>First, we get that <span class="math inline">\(F^{-1}(U)=\frac{b}{(1-u)^{\frac{1}{a}}},1&gt; u ≥ 0\)</span>, then generate a random u from Uniform(0,1) and Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison, where <span class="math inline">\(f(x)=8x^{-4}\)</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb3-4"><a href="#cb3-4"></a>x&lt;-<span class="dv">2</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">*</span>x<span class="op">^-</span><span class="dv">4</span>))</span>
<span id="cb3-6"><a href="#cb3-6"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">100</span>, <span class="fl">.01</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">*</span>y<span class="op">^</span>(<span class="op">-</span><span class="dv">4</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),\left\vert x \right\vert\le 1\]</span> Devroye and Gy¨orfi [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1, U_2, U_3\)</span> ∼ Uniform(−1, 1). If <span class="math inline">\(|U_3|\)</span> ≥ <span class="math inline">\(|U_2|\)</span> and <span class="math inline">\(|U_3| ≥ |U_1\)</span>|, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<p>We can get the cdf:<span class="math display">\[F(x)=-\frac{1}{4}x^3+\frac{3}{4}x+\frac{1}{2},\left\vert x \right\vert\le 1\]</span> Let F(x)=u, we get a cubic equation in one unknown:<span class="math inline">\(x^3-3x+4u-2=0\)</span>, since <span class="math inline">\(\left\vert x \right\vert\le 1\)</span>, <span class="math inline">\(x=2\sqrt[3]{r}cos(\theta+\frac{4}{3}\pi)\)</span>, where r=1, <span class="math inline">\(\theta=\frac{1}{3}arccos(-\frac{4u-2}{2r})\)</span>. Then use the inverse transform method to simulate a random sample and construct the histogram density estimate of the simulated random sample.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb4-4"><a href="#cb4-4"></a>r&lt;-<span class="dv">1</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>q&lt;-<span class="dv">4</span><span class="op">*</span>u<span class="dv">-2</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>theta&lt;-<span class="kw">acos</span>(<span class="op">-</span>q<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>r))<span class="op">/</span><span class="dv">3</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>x&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">cos</span>(theta<span class="op">+</span><span class="dv">4</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Prove that the algorithm given in Question 2 generates variates from the density <span class="math inline">\(f_e\)</span></p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<p>We deliver the <span class="math inline">\(u_0\)</span> according to the question and construct the histogram of <span class="math inline">\(u_0\)</span>. To prove that the algorithm given in Question 2 generates variates from the density <span class="math inline">\(f_e\)</span> we graph the density <span class="math inline">\(f_e\)</span> for comparison. Since they have a high degree of coincidence, the proposition is proved.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>u0&lt;-<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a>u1&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a>u2&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>u3&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="cf">if</span>(<span class="kw">abs</span>(u3[i])<span class="op">&gt;=</span><span class="kw">abs</span>(u2[i]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(u3[i])<span class="op">&gt;=</span><span class="kw">abs</span>(u1[i])){</span>
<span id="cb5-9"><a href="#cb5-9"></a>  u0[i]=u2[i]</span>
<span id="cb5-10"><a href="#cb5-10"></a> }<span class="cf">else</span></span>
<span id="cb5-11"><a href="#cb5-11"></a> {u0[i]=u3[i]</span>
<span id="cb5-12"><a href="#cb5-12"></a> }</span>
<span id="cb5-13"><a href="#cb5-13"></a>}</span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="kw">hist</span>(u0,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb5-15"><a href="#cb5-15"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, <span class="fl">.01</span>)</span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="kw">lines</span>(y, (<span class="dv">3</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-(\frac{\beta}{\beta+y})^r, y\ge 0\]</span>. (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with r = 4 and β = 2. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<p>First, we get that <span class="math inline">\(F^{-1}(U)=\frac{\beta}{\sqrt[r]{1-u}}-\beta\)</span>, then generate a random u from Uniform(0,1) and graph the density histogram of the sample and superimposing the Pareto density curve for comparison, where r=4, <span class="math inline">\(\beta=2\)</span>, and the pdf: <span class="math inline">\(f(y)=\frac{r\beta^r}{(\beta+y)^{r+1}}\)</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>n&lt;-<span class="dv">1000</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb6-4"><a href="#cb6-4"></a>r&lt;-<span class="dv">4</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>beta&lt;-<span class="dv">2</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>y&lt;-beta<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>r)<span class="op">-</span>beta</span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="kw">hist</span>(y,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(y)<span class="op">==</span><span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>))</span>
<span id="cb6-8"><a href="#cb6-8"></a>z&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>, <span class="fl">.01</span>)</span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="kw">lines</span>(z,r<span class="op">*</span>beta<span class="op">^</span>r<span class="op">/</span>(beta<span class="op">+</span>z)<span class="op">^</span>(r<span class="op">+</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It shows that they have a high degree of coincidence.</p>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>Homework 3</h1>
<div id="question-5.1" class="section level2">
<h2>Question 5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\pi/3} sin\,t\, {\rm d}t\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-5.1" class="section level2">
<h2>Answer 5.1</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>t&lt;-<span class="kw">runif</span>(m,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>theta.hat&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(t))<span class="op">*</span>(pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="kw">print</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.5043115</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">print</span>(<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)<span class="op">+</span><span class="kw">cos</span>(<span class="dv">0</span>))</span></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<p>The estimate is <span class="math inline">\(\hat{\theta}\dot{=}0.5043115\)</span> and <span class="math inline">\(\theta=0.5\)</span>.</p>
</div>
<div id="question-5.7" class="section level2">
<h2>Question 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-5.7" class="section level2">
<h2>Answer 5.7</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>n&lt;-<span class="dv">10000</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb11-4"><a href="#cb11-4"></a>T1&lt;-<span class="kw">exp</span>(u) <span class="co">#simple MC</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>theta1&lt;-<span class="kw">mean</span>(T1)</span>
<span id="cb11-6"><a href="#cb11-6"></a>s1&lt;-<span class="kw">var</span>(T1)<span class="op">/</span>n</span>
<span id="cb11-7"><a href="#cb11-7"></a>n1&lt;-n<span class="op">/</span><span class="dv">2</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>u1&lt;-u[<span class="dv">1</span><span class="op">:</span>n1]</span>
<span id="cb11-9"><a href="#cb11-9"></a>y1&lt;-<span class="kw">exp</span>(u1)</span>
<span id="cb11-10"><a href="#cb11-10"></a>y2&lt;-<span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>u1)</span>
<span id="cb11-11"><a href="#cb11-11"></a>y&lt;-(y1<span class="op">+</span>y2)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>theta2&lt;-<span class="kw">mean</span>(y) <span class="co">#antithetic variables</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>s2&lt;-<span class="kw">var</span>(y)<span class="op">/</span>n1</span>
<span id="cb11-14"><a href="#cb11-14"></a>theta1</span></code></pre></div>
<pre><code>## [1] 1.718662</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>theta2</span></code></pre></div>
<pre><code>## [1] 1.716873</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>(s1<span class="op">-</span>s2)<span class="op">/</span>s1</span></code></pre></div>
<pre><code>## [1] 0.9678507</code></pre>
<p>The estimate with the simple Monte Carlo method is <span class="math inline">\(\hat{\theta}_1=1.718662\)</span></p>
<p>The estimate with the antithetic variate approach is <span class="math inline">\(\hat{\theta}_2=1.716873\)</span></p>
<p>The empirical estimate of the percent reduction is 96.78507%</p>
<p>Now compute the theoretical value of the percent reduction：</p>
<p>If the simple Monte Carlo approach is applied with n replicates, the variance of the estimator is <span class="math inline">\(Var(\hat{\theta}_1)=Var(e^u)/n\)</span>, where</p>
<p><span class="math display">\[Var(e^u)=E[e^{2u}]-(E[e^u])^2=-\frac{1}{2}e^2+2e-\frac{3}{2}\]</span></p>
<p>Then we compute</p>
<p><span class="math display">\[Cov(e^u,e^{1-u})=e-(e-1)^2\]</span> As for antithetic variate approach ,the variance of the estimator is <span class="math inline">\(Var(\hat{\theta}_2)=Var(\frac{e^u+e^{1-u}}{2})/(n/2)\)</span>, where</p>
<p><span class="math display">\[Var(\frac{e^u+e^{1-u}}{2})=\frac{1}{4}(Var(e^u)+Var(e^{1-u})+2Cov(e^u,e^{1-u}))=-\frac{3}{4}e^2+\frac{5}{2}e-\frac{5}{4}\]</span> So the theoretical value of the percent reduction is:<span class="math inline">\(\frac{Var(\hat{\theta}_1)-Var(\hat{\theta}_2)}{Var(\hat{\theta}_1)}=0.9676701\)</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>e&lt;-<span class="kw">exp</span>(<span class="dv">1</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>v1=(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>e<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>e<span class="dv">-3</span><span class="op">/</span><span class="dv">2</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>v2=(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>e<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">5</span><span class="op">*</span>e<span class="op">/</span><span class="dv">2-5</span><span class="op">/</span><span class="dv">4</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>(v1<span class="dv">-2</span><span class="op">*</span>v2)<span class="op">/</span>v1</span></code></pre></div>
<pre><code>## [1] 0.9676701</code></pre>
</div>
<div id="question-5.11" class="section level2">
<h2>Question 5.11</h2>
<p>If <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are unbiased estimators of θ, and <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are antithetic, we derived that <span class="math inline">\(c^*\)</span> = 1/2 is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_c\)</span>= c<span class="math inline">\(\hat{\theta}_1\)</span> + (1 − c)<span class="math inline">\(\hat{\theta}_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are any two unbiased estimators of θ, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_c\)</span> = c<span class="math inline">\(\hat{\theta}_1\)</span> + (1 − c)<span class="math inline">\(\hat{\theta}_2\)</span> in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-5.11" class="section level2">
<h2>Answer 5.11</h2>
<p><span class="math display">\[Var(\hat{\theta}_c)=c^2Var(\hat{\theta}_1)+(1-c)^2Var(\hat{\theta}_2)+2c(1-c)Cov(\hat{\theta}_1,\hat{\theta}_2)\]</span> Simplify this formula, we get that</p>
<p><span class="math display">\[Var(\hat{\theta}_c)=Var(\hat{\theta}_1-\hat{\theta}_2)c^2-2[Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)]c+Var(\hat{\theta}_2)\]</span> If <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are not the same, then <span class="math inline">\(Var(\hat{\theta}_1-\hat{\theta}_2)＞0\)</span>, and the <span class="math inline">\(c^*\)</span> is <span class="math display">\[c^*=\frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}\]</span></p>
<p>If <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are the same, then any <span class="math inline">\(0\le c\le1\)</span> is ok.</p>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<p>Find two importance functions f1 and f2 that are supported on (1, ∞) and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},x&gt;1\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty} \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\, {\rm d}x\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-5.13" class="section level2">
<h2>Answer 5.13</h2>
<p>Let <span class="math display">\[f_1(x)=\sqrt{\frac{2}{\pi}}e^{-\frac{x^2}{2}},~~x&gt;0\]</span> <span class="math display">\[f_2(x)=xe^{-\frac{x^2}{2}},~~x&gt;0\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>x&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,.<span class="dv">01</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>w&lt;-<span class="dv">2</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>f1&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb19-4"><a href="#cb19-4"></a>f2&lt;-x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a>g&lt;-x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="kw">plot</span>(x,g,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">lwd=</span>w)</span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="kw">lines</span>(x,f1,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">lwd=</span>w)</span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="kw">lines</span>(x,f2,<span class="dt">lty=</span><span class="dv">3</span>,<span class="dt">lwd=</span>w)</span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>),<span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">lwd=</span>w,<span class="dt">inset=</span><span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmZmZmtv+QOgCQZgCQkGaQ2/+2ZgC2tma2/7a2///bkDrb2//b/9vb////tmb/25D//7b//9v///9EnQAkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHmklEQVR4nO2daWOjNhRFlWRm2rht2qEt7eDl///MMZtZYulK6Ak94J4PiePIT/hYaAebG3Fich+AdigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBwgRdP0zD67+JDkcfQYJK894+qPoH+ydE0PXjoaV8+5HgYDQSIuhy+qN/WB3mJGMJAgTWQV0RYh1k4XJqW7HDlB/2gyAUBFggqDLm5bv8kSglTFBhzPv51x/jBn/vBAkq7pVz0ZQeNvPPaMrN+VstyNZRNJshjaC693P972YvQeNw/geRgSSCbmVfblpVoyjPPhhpQaLFJ42gW9k2X5Wx1dGTcMKG5KKlExQULuhUD4wdHUmBoNEpJ+NpU4JKWys2PGrO9FbNAQXhcI0UCrKGe6gRfVtykRQI6n4dSxBc1ZgLkmzqNyAIr2r04cwgSOx96RfkMSc9COp/dpV1QDY29AvyWNU4tiD/EmTGgsxhBHmsakyrZrnSM4otEylRKwZXNY4uyDfcVJBQHjsSZMbdRAr6HO6h5HGOSUjasqDZjOJUhwZBhTEvfz0Wq/SUoO4vk0IQmFOdUNy7bZXRKkiqHZsH9Rd0/lp3Two9guZPphAUQtvvryjIRqlekEguey5BIrX08ghtHVRqFPQYtGYVpK4VG/2tQ1DdD3r9+zFFo1CQhumOSq+g3PNBTR002k9AQXOquvM47CegIBxJj6C+lpaPHRVJi6Chlo53tE9B/fMU5A6XX9D5l2GhKvuE2bMEApnEvPhyes0pCIaT6CrGRKgm+wkoaE5l3ivdghKMxeYnNTjJ1xDUdtYrr+0vwzN9VzFakWXK1fL3nNUENavy1ms11hMUylqCOjU+O+27Zw4mqJ2cg9tfRs+Y6e/lbEPQ0hJ0EEH1ifLl9vlaDUe456utS9Av6NY4evnuuOj5STix/a6bELQgnNh2zl0PVm8UBMNREAiXuQ6aRUrYirV494OGfx2gBF0/0E1fXOEOIOhu6MvycEcQZLta1TmjKNXOb0LQknAKBDVXKQ2dW6WCYs+x5a++fty7/6V5VA/qBMmMV5e/utsftObmBXxR7/jJJILmUWEumneY9b+jcpu+2MwGwfPfnyk0bn9pn0whKJjRFIRWQZHnWOR0x1BHJ+0oOgcaKFxcEYoSNJnCSibI/6Jey3+zCSonB5xKUMBFvbbcMgkqpwOAdKN574t6bbnlEXT+OrvdEUvQlLKtOdP3g7wv6rXmFmNoC4NV34t6Pz0t0dBvQdDScBQEwomMV7csCG3BMxKjjS0LguEkzjEKWhh7USTFghbnSEELYy+KpE3QkICCUIrFhigIv1IKzYKkrqKPRLUgDYb0CRLpTMtBQQB9gsaLPwoMqRSkqQhpFqSiHVMoSGS4IYZqQRqKkEZBQyIFRUjZjOLn1CLZRqC6BGmohSgIHYF4wobI3R2KGrI0gmJ3dyjqLCYRJLE2r2W8kURQ/O6O8U7CvIaUlqBRydmjoPjdHdMRWU5DiVqxpbs7nibNakh5P6hJmtXQBgTlNaS0ozhLl1GR0o7iI1n21l5rM98ne5jxnwOQRWtHcUg4EbS+I+UlqEk66hCtStiBynQUZ7kHsbaflIJEO4p52UI/KCsUBEgtKOiaVY1kK0GbIZOgiGxwEpEgoe+YgkSTw8FqRDZ7EIQHqxHZ7ECQx1AjIpsdCPIYrEZkswNBLEEIvKoRkc0eBOHBakQ2uxB0QCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBgBUGzexXbKNxTBOevxoC7fde3KrN8KVMXo/0av2p0OzNIekHzexVbqNxzKNX9v5eTM0jZfCWKw1D3NX71TW8rb0PpBc3vVfycy8kpqJ3MdAZpbydf2B12X+PXhnKkm7JWHYQ+svLtT5eg8zf4iSNB/df4+X1gD9YSVLgP6C7AWQdVr/+cUEUGT7F2qaF17b3qsJIgMIldF3unoLI+O9B3MsDKt7HSlmXvSmgdQRWoo+tFEregF/yx14V0flPS2WFoFYQWQZpS7xbUqOm+Hs8SBNctWk+xEvWCunutOuqP9v04q2qPkqG0ki7dvbceZwlqF3WdH3v7xp1JKpXNvLtaGHD3pOtaarSy+zSAXx2krqM4v1exDTDUqPB4pUBJuuJV6hpqbBwKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIIB2QfVOsMsp8DYGkmgXVG+aCr0PhijaBdU7pH/z3u2UAPWCbgW8zCMp+gW5N88nR72g68fvwTcEk0S9oPLtf/fm1sRoF1RvkA693ZUo2gUVzf7ojNW0dkHZoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAD8Br1/gJKwWRSsAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">plot</span>(x,g<span class="op">/</span>f1,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="dt">lwd=</span>w,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">lines</span>(x,g<span class="op">/</span>f2,<span class="dt">lty=</span><span class="dv">3</span>,<span class="dt">lwd=</span>w)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>),<span class="dt">lty=</span><span class="dv">2</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">lwd=</span>w,<span class="dt">inset=</span><span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmZmZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb2//b/9vb////tmb/25D//7b//9v////QSQHAAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGkUlEQVR4nO2d7WKqRhRFSWrS29jWXlpa8eP9X7MCisEws/iYYQ5xrz/+CNno8nAEZoDsLLxkqd+AdSQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAgILylZDTEGH9z9DxiUhiqDj9v4FvP4zO24sQcsnTgWV2Uf1MreChtf3+OyhSZE2seN2s+8TNG7T/saCzuf85acqyEuRfUiQl8P7LxLk5bTLZgkasRMyOntwUtT9oJlxE/1IUIjswUmWBaXPliBOkiBIkiBIkiBIsito6m+YBAXI9nH4cT9BI0FfOW5fJchD2TnFZ1nQ1AOxIdluyuyjXI2gUNmPp+jglN3TCXo8h0nnNJ9O0FjWIihZtgQBEgQsKOiyT/HyM1zcYNYgKM+yj8Nv+8t+qeOs9JMLyjf7emDsfC6qAcS5cSOxf7Ba183h10pQ2R2bHzqyOuNHfh2CqqH507/nqRU04zgDs0cmxdnEilvdNKpGx83yswZB56L5+SqdI4fPLmhe3Lwt7CkExcsemyRBHU67S/Xe26ZVQcmyT7tL7yyyt09JEvSZZkJT+xssQf2U7RHkcwi6dTTX6xfy56qg2z6D6/UL5b1LP4WgsZT3Hm1U0Mwf+Zlv9VP9SFAPxWc/NgXNPM7wZiNF9+DRqKB42cThvXvyQYIeKJqTeab3g+YeyY/5TJxmUtC83G8vyFT29xJ0n54QLlKCIDLeOelLr633KIoUl2SGTIojqDpnf9xWxzTLCOp2dvuCTrt6XGy32Y8VNPUCqJUJuo3I55t9MW5kdf5e4nkNgpoKupC/jaugCXuJPf9hX1C7YR23466bn1BA6xTUHhWfdrEFDc6emGRqP2jkFuZuZMEwJ2hURJh6o7UEXzBJXDzWKWiR2rmuKviCS8RJkB1WJ2jB4mnWF3zB6XGDVvG8gpb51R6NJUH4PykMShCtNPiCE+OMbmGWBHkXT2ZPggAzgqxiX1Di3iRBtPrgCyaJi4dpQRZ++W0I6jdhYtfIhCATJhxEGji8n/YeMqrRN3RjRVmcCnKP9vSNrPYUkJ2airSJnXZv/gW6gkZlL0usHuS+GPNrXDakY6fCRJPu/kWCIsTFw5YgW8VTY0qQsa2rJr0ge046pBbUFo3B4qlJL+j2KkF9cWa9tKQV1PgxLSm1oLP1KjIgyDbJe1DY2PCkriAJWiYuHhIESBAgQYAEARIERDtp7x30eXpB7S1COvdSmRyXkiiC2gvq0tzsNiiRRlbbMZ+JN7u1gyoIiNWDriWkHuTgNn3BUT8StHRcPJIJWg2JBM1YDS8SJGTsJ5agsItPRYLmr0aCZi8iQUuESFCARWYsPhUJmr+a5xa0XiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAhYQ9PD8PBe5czSy5vCeZXDBbHu/dGfGj3pGge9h1V+IL+jx+XkOSvdwbf3nzf56M3Qn1f3SvdfUHrf1lIvqQWzlYEPxBT0+P6+f49YrqJk34Q1prsjO3Q7LZuJXE+VZrstSPYi+smLzl09Q84RpLySozD7qSTvDvrCWpQTl/jd0EeDtQeXr31tqZLiJNbOaep/m7WYhQc75Mg1V2XsFFdXWQbc1wOZbW2lqeXATWkZQCT26mo/lF/TCX3tVpI8Pynp4G1YFQf00Ve8XVKtp2ocrhHuL1U2soL2g6/O/PP2j+TzeVj2gMow26QLu93HFW0HN/FHv1958cO8ipcmfeX9buOPfk6661KdJpL0Bw3qQuR3Fx+fnuYBDjZKPV3Ja5Fpeha1DjZUjQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYB1QdVMsON22AyjKFgXVE2act1ybxGsC6pmSP8+eLZTBMwLOud4mUdU7AuiZ75Fxryg0+6PoTN2o2BeULH5zz+5NTLWBVUTpAfPio+BdUF5PT86YZu2Lig5EgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBwP8bnwNg/svy3gAAAABJRU5ErkJggg==" /><!-- --></p>
<p>The first figure represents two importance functions, the second figure represents g(x)/f(x). The function that corresponds to the most nearly constant ratio g(x)/f(x) appears to be f2. From the graphs, we might prefer f2 for the smallest variance.</p>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-5.15" class="section level2">
<h2>Answer 5.15</h2>
<p>We divide the interval (0,1) into five subintervals , (j/5,(j + 1)/5), j = 0, 1,…, 4. Then on the jth subinterval variables are generated from the density <span class="math display">\[\frac{e^{-x}}{e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}}}\]</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>theta.hat&lt;-s&lt;-<span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a>g&lt;-<span class="cf">function</span>(x){</span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="kw">exp</span>(<span class="op">-</span>x<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb21-6"><a href="#cb21-6"></a>}</span>
<span id="cb21-7"><a href="#cb21-7"></a>u1&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb21-8"><a href="#cb21-8"></a>x1&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb21-9"><a href="#cb21-9"></a>fg1&lt;-<span class="kw">g</span>(x1)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x1)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb21-10"><a href="#cb21-10"></a>theta.hat[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(fg1)</span>
<span id="cb21-11"><a href="#cb21-11"></a>s[<span class="dv">1</span>]&lt;-<span class="kw">var</span>(fg1)</span>
<span id="cb21-12"><a href="#cb21-12"></a></span>
<span id="cb21-13"><a href="#cb21-13"></a>u2&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>,<span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb21-14"><a href="#cb21-14"></a>x2&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u2<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb21-15"><a href="#cb21-15"></a>fg2&lt;-<span class="kw">g</span>(x2)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x2)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb21-16"><a href="#cb21-16"></a>theta.hat[<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(fg2)</span>
<span id="cb21-17"><a href="#cb21-17"></a>s[<span class="dv">2</span>]&lt;-<span class="kw">var</span>(fg2)</span>
<span id="cb21-18"><a href="#cb21-18"></a></span>
<span id="cb21-19"><a href="#cb21-19"></a>u3&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">5</span>,<span class="dv">2</span><span class="op">/</span><span class="dv">5</span>,<span class="dv">3</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb21-20"><a href="#cb21-20"></a>x3&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u3<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb21-21"><a href="#cb21-21"></a>fg3&lt;-<span class="kw">g</span>(x3)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x3)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb21-22"><a href="#cb21-22"></a>theta.hat[<span class="dv">3</span>]&lt;-<span class="kw">mean</span>(fg3)</span>
<span id="cb21-23"><a href="#cb21-23"></a>s[<span class="dv">3</span>]&lt;-<span class="kw">var</span>(fg3)</span>
<span id="cb21-24"><a href="#cb21-24"></a></span>
<span id="cb21-25"><a href="#cb21-25"></a>u4&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">5</span>,<span class="dv">3</span><span class="op">/</span><span class="dv">5</span>,<span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb21-26"><a href="#cb21-26"></a>x4&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u4<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb21-27"><a href="#cb21-27"></a>fg4&lt;-<span class="kw">g</span>(x4)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x4)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">3</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb21-28"><a href="#cb21-28"></a>theta.hat[<span class="dv">4</span>]&lt;-<span class="kw">mean</span>(fg4)</span>
<span id="cb21-29"><a href="#cb21-29"></a>s[<span class="dv">4</span>]&lt;-<span class="kw">var</span>(fg4)</span>
<span id="cb21-30"><a href="#cb21-30"></a></span>
<span id="cb21-31"><a href="#cb21-31"></a>u5&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">5</span>,<span class="dv">4</span><span class="op">/</span><span class="dv">5</span>,<span class="dv">5</span><span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb21-32"><a href="#cb21-32"></a>x5&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u5<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">5</span><span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb21-33"><a href="#cb21-33"></a>fg5&lt;-<span class="kw">g</span>(x5)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x5)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">5</span><span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb21-34"><a href="#cb21-34"></a>theta.hat[<span class="dv">5</span>]&lt;-<span class="kw">mean</span>(fg5)</span>
<span id="cb21-35"><a href="#cb21-35"></a>s[<span class="dv">5</span>]&lt;-<span class="kw">var</span>(fg5)</span>
<span id="cb21-36"><a href="#cb21-36"></a></span>
<span id="cb21-37"><a href="#cb21-37"></a><span class="kw">sum</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.5242221</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">mean</span>(s)</span></code></pre></div>
<pre><code>## [1] 4.430502e-07</code></pre>
<p>We get that <span class="math inline">\(\hat{\theta}=0.5242221\)</span> and the variance of the estimator is 4.430502e-07 Compare it with the result of Example 5.10 and we konw that two estimators are similar with each other, but more than 99% reduction in variance.</p>
</div>
<div id="question-6.4" class="section level2">
<h2>Question 6.4</h2>
<p>Suppose that X1,…,Xn are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter µ. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-6.4" class="section level2">
<h2>Answer 6.4</h2>
<p>If <span class="math inline">\(lnX\sim N(\mu,\sigma^2)\)</span>, let <span class="math inline">\(Y=LnX\)</span>, <span class="math inline">\(S^2\)</span> is the sample variance of Y, then <span class="math display">\[T=\frac{\sqrt{n}(\bar{Y}-\mu)}{S}\sim t(n-1)\]</span> The confidence interval is given by <span class="math display">\[(\bar{Y}-\frac{S}{\sqrt{n}}t_{\alpha/2}(n-1),\bar{Y}+\frac{S}{\sqrt{n}}t_{\alpha/2}(n-1))\]</span></p>
<p>Here we let µ = 0, σ = 2, n = 20, m = 1000 replicates, and α = 0.05. The sample proportion of intervals that contain µ = 0 is a Monte Carlo estimate of the true confidence level.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>UCL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr=</span>{</span>
<span id="cb25-5"><a href="#cb25-5"></a>  x&lt;-<span class="kw">rlnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">-</span><span class="kw">sd</span>(<span class="kw">log</span>(x))<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb25-7"><a href="#cb25-7"></a>})</span>
<span id="cb25-8"><a href="#cb25-8"></a>LCL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr=</span>{</span>
<span id="cb25-9"><a href="#cb25-9"></a>  x&lt;-<span class="kw">rlnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</span>
<span id="cb25-10"><a href="#cb25-10"></a>  <span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">+</span><span class="kw">sd</span>(<span class="kw">log</span>(x))<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb25-11"><a href="#cb25-11"></a>})</span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="kw">sum</span>(UCL<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>LCL<span class="op">&lt;</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 957</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>LCL<span class="op">&lt;</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.957</code></pre>
<p>The result is that 957 intervals satisfied (UCL &gt; 0 &amp; LCL &lt; 0), so the empirical confi- dence level is 95.7% in this experiment. ## Question 6.5</p>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of χ2(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-6.5" class="section level2">
<h2>Answer 6.5</h2>
<p>The confidence interval is given by <span class="math display">\[(\bar{X}-\frac{S}{\sqrt{n}}t_{\alpha/2}(n-1),\bar{X}+\frac{S}{\sqrt{n}}t_{\alpha/2}(n-1))\]</span> Where <span class="math inline">\(S^2\)</span> is the sample variance of Y Then use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of χ2(2) data with sample size n = 20. Here, the mean of the chi-square distribution is 2.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>UCL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr=</span>{</span>
<span id="cb29-5"><a href="#cb29-5"></a>  x&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb29-6"><a href="#cb29-6"></a>  <span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb29-7"><a href="#cb29-7"></a>})</span>
<span id="cb29-8"><a href="#cb29-8"></a>LCL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr=</span>{</span>
<span id="cb29-9"><a href="#cb29-9"></a>  x&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb29-10"><a href="#cb29-10"></a>  <span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb29-11"><a href="#cb29-11"></a>})</span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="kw">sum</span>(UCL<span class="op">&gt;</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>LCL<span class="op">&lt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 920</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>LCL<span class="op">&lt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.92</code></pre>
<p>The result is that 920 intervals satisfied (UCL &gt; 2&amp; LCL &lt; 2), so the empirical confi- dence level is 92.0% in this experiment and is not much different with 95%. So the coverage is better than the simulation results in Example 6.4.</p>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>Homework 5</h1>
<div id="question-6.7" class="section level2">
<h2>Question 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(α, α) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(ν)?</p>
</div>
<div id="answer-6.7" class="section level2">
<h2>Answer 6.7</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">set.seed</span>(<span class="dv">102</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>sk&lt;-<span class="cf">function</span>(x){</span>
<span id="cb33-3"><a href="#cb33-3"></a>  xbar&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb33-4"><a href="#cb33-4"></a>  m3&lt;-<span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb33-5"><a href="#cb33-5"></a>  m2&lt;-<span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a>  <span class="kw">return</span>(m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb33-7"><a href="#cb33-7"></a>}</span>
<span id="cb33-8"><a href="#cb33-8"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb33-9"><a href="#cb33-9"></a>n&lt;-<span class="dv">30</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>a&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">5</span>,<span class="dv">100</span>,<span class="dv">5</span>))</span>
<span id="cb33-12"><a href="#cb33-12"></a>N&lt;-<span class="kw">length</span>(a)</span>
<span id="cb33-13"><a href="#cb33-13"></a>pwr&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb33-14"><a href="#cb33-14"></a>cv&lt;-<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb33-15"><a href="#cb33-15"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb33-16"><a href="#cb33-16"></a>  a1&lt;-a[j]</span>
<span id="cb33-17"><a href="#cb33-17"></a>  sktests&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb33-18"><a href="#cb33-18"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb33-19"><a href="#cb33-19"></a>    x&lt;-<span class="kw">rbeta</span>(n,a1,a1)</span>
<span id="cb33-20"><a href="#cb33-20"></a>    sktests[i]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span>cv)</span>
<span id="cb33-21"><a href="#cb33-21"></a>  }</span>
<span id="cb33-22"><a href="#cb33-22"></a>  pwr[j]&lt;-<span class="kw">mean</span>(sktests)</span>
<span id="cb33-23"><a href="#cb33-23"></a>}</span>
<span id="cb33-24"><a href="#cb33-24"></a><span class="kw">plot</span>(a,pwr,<span class="dt">xlab=</span><span class="kw">bquote</span>(a),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>))</span>
<span id="cb33-25"><a href="#cb33-25"></a>se&lt;-<span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr)<span class="op">/</span>m)</span>
<span id="cb33-26"><a href="#cb33-26"></a><span class="kw">lines</span>(a,pwr<span class="op">+</span>se,<span class="dt">lty=</span><span class="dv">3</span>)</span>
<span id="cb33-27"><a href="#cb33-27"></a><span class="kw">lines</span>(a,pwr<span class="op">-</span>se,<span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAS1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6kNtmAABmADpmtv+QOgCQZgCQ2/+2ZgC225C2/7a2///bkDrb////tmb/25D//7b//9v///8qHShYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG60lEQVR4nO2ci5ajKBRFrUdPpztTmSnbSvL/X9oqYB4Kx0cUUuy9ZlYnlRvQ7QVRiMUZghSxNyB1ECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkGCaoNO+aHn9XGlz0mOSoLL4aV5U7sX3Z4qg077TUr79WWFjUmSKoOPut3tZZdPIyCDBxD7IphB9kIfjzpzFsskfxkESBAmmCSrr5tV2QyVnsSHKl4+6G3o/+wUVT8Magsxp/rSvu2ivoAnFRWUVQW6geHj7g6AhuoHi4R1Bgzgt9XDoVtD0ph2bdQR1Q+nTngxaud7YIEiwtiA66bXrjQ2CBAgSrCRIzmpkLkjPauQtaMQ96bwFjZjVyFsQGaTQsxqZC9KzGrkL2rq49UCQAEECBAkQJECQAEECBAkQJECQAEGCjQUxsxqpuPVAkABBAgQJECRAkABBAgQJECRAkABBAlZ3CKYLuppX9pL16o6rlQk+Mp+b1z9DzXt1h5t2D/wmPvMMGgGrOxQ5r+6o9/19w3pjMyODbHa8fGxSb2xmN7HjbtGvUb+5oCaJyCBf4NcP9dibbiTgHwx8Y0Fj2pb3d3TT643NnCZWp5A6j532IuJbCzq3Dw4IX5FVw59nNLPKWcwbeJDXYo+sNzazRtLLzvDT6o3N2rdcs/zNajvMWfjopO8sqGpbWMlI2hN42ndPLtmi3tjM6KR/mdQJ3nnNe1bDZFDoAYBZz2rYQXIZGErnfU96xKV63rMaI8g7g8bArIYi51mNjeuNDYIECBIgSIAgAYIECLL45hGeXND06RHPN4qzZ5ueW1B/t+73v3tvX3TfcB+Yf4vmxW1RV18YvS0PZGFxbrfMjp29+395b/63IoruA1vMlaziUqA3rVbYo4XF3R5vs+Vuv5wk+6/Zy9v3hRNjSzlfvW9FXDLIhHeBWwuaObN6e7x7O3YRYaPv358HxLj3dqvs27sPUs+gq3S/PeK2CJtJXjG9DLpvareZ49qrUVUkLOimJfUPq7V2FehpWr0+qNc53XczF5kDHy7Yo8kEi+sOszuKdxl0lTW33/B21lcvzrfve38fKGn5Hk1nuLiuLyiu92DgePc6Me/pffqWFT314743s74pxdlG0+sH/Md7fVIS5IT0+oGYpCGoG86eb8UksNAqCUFd0+r6m/hiHCkIuoxLHl/PYtIQlGDmOFYSNGnxQpqpY1lH0KTFC0n7WUfQpKnnRJuWYxVBYxcvdJcOCRMzg9K3c16vDxqxeKH7L2lWOouNWbxgr0snlbs9EcdBWWfQqOJSPrt3RB0oJnx270hgoJg28QeKiRN1oPgMkEGCjQeKGf0kMwyrXDerNzYIEqwtKMufZD6k3qchkqCltaUQsCh8ISns/6qC5MXq0tpSCFgQri9Wl9aWQsD88BGXGktrSyFgfviIi9WltaUQMD+cDFLoWY2ltaUQsCRcXqwurS2FgEXh+YEgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSLCNoPZednuHpPI/FN48wdEX0Dww/T1UQlnYZz0HqpjBJoJO+3qLy2b/msd9VsObX7U3UXwBVf3hcRcooXmEaPsgv0AVc9hE0NeP9gmEr5/mnuRh6LHmx10jyBdg/h4owTwrvf57oIpZbNgH1Ye1M9X/tHz7txbkC/j6x6aEL6ATFKhiFhsKOrx+mv0cuuNff9L0Qb6A6vX/XduLeUtwTcxfxTy2E9TcxzZ9w0AP0TSMRpAvoGzmKpss8Zbg+mZ/wDw2E1S5Pnpw65tZkqCgF5sX3hLq/KybV+AYzGQrQWYexJf/7d9DTcz0KXX/4i3BdT1P2sTspLWvBy3tmpTfvgCzw/XOewNc4jxnJ+0m1ILn4EPgNG8mdSv/ad54CQTMZaNxkJtnDI3iDqGBYuns+QJcH/SUA0XbgpqtLtWlhi+gchcrvoCDCpgHF6sCBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAmSF3RwC+gjkbqgZqlY+cDlPpNJXNDx14dbXheJxAU1VFHbWOqCyqJ4/Y8M8tK2LpqYn3Z9dEUT89Ikz3E382lFDyFxQWZN7yHieT51QdFBkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJ/gKWOrr6h/aGrQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>图为对对称Beta(α，α)分布估计偏度正态性检验的功效<span class="math inline">\(\hat{\pi}(\epsilon)\pm\hat{se}(\hat{\pi}(\epsilon))\)</span>可以看出当α大于20时，经验检验功效均与0.05即所选取的显著水平相近。</p>
</div>
<div id="question-6.8" class="section level2">
<h2>Question 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{α} \dot{=} 0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-6.8" class="section level2">
<h2>Answer 6.8</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">set.seed</span>(<span class="dv">103</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>count5test&lt;-<span class="cf">function</span>(x,y){</span>
<span id="cb34-3"><a href="#cb34-3"></a>  X&lt;-x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb34-4"><a href="#cb34-4"></a>  Y&lt;-y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb34-5"><a href="#cb34-5"></a>  outx&lt;-<span class="kw">sum</span>(X<span class="op">&gt;</span><span class="kw">max</span>(Y))<span class="op">+</span><span class="kw">sum</span>(X<span class="op">&lt;</span><span class="kw">min</span>(Y))</span>
<span id="cb34-6"><a href="#cb34-6"></a>  outy&lt;-<span class="kw">sum</span>(Y<span class="op">&gt;</span><span class="kw">max</span>(X))<span class="op">+</span><span class="kw">sum</span>(Y<span class="op">&lt;</span><span class="kw">min</span>(X))</span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx,outy))<span class="op">&gt;</span><span class="dv">5</span>))</span>
<span id="cb34-8"><a href="#cb34-8"></a>}</span>
<span id="cb34-9"><a href="#cb34-9"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb34-10"><a href="#cb34-10"></a>sigma1&lt;-<span class="dv">1</span></span>
<span id="cb34-11"><a href="#cb34-11"></a>sigma2&lt;-<span class="fl">1.5</span></span>
<span id="cb34-12"><a href="#cb34-12"></a>n&lt;-<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">500</span>,<span class="dv">10000</span>)</span>
<span id="cb34-13"><a href="#cb34-13"></a>CFpower&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb34-14"><a href="#cb34-14"></a>Fpower&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb34-15"><a href="#cb34-15"></a></span>
<span id="cb34-16"><a href="#cb34-16"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb34-17"><a href="#cb34-17"></a>  CFpower[i]&lt;-<span class="kw">mean</span>(<span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</span>
<span id="cb34-18"><a href="#cb34-18"></a>  x&lt;-<span class="kw">rnorm</span>(n[i],<span class="dv">0</span>,sigma1)</span>
<span id="cb34-19"><a href="#cb34-19"></a>  y&lt;-<span class="kw">rnorm</span>(n[i],<span class="dv">0</span>,sigma2)</span>
<span id="cb34-20"><a href="#cb34-20"></a>  <span class="kw">count5test</span>(x,y)</span>
<span id="cb34-21"><a href="#cb34-21"></a>}))</span>
<span id="cb34-22"><a href="#cb34-22"></a>  </span>
<span id="cb34-23"><a href="#cb34-23"></a>  pvalues&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</span>
<span id="cb34-24"><a href="#cb34-24"></a>  x&lt;-<span class="kw">rnorm</span>(n[i],<span class="dv">0</span>,sigma1)</span>
<span id="cb34-25"><a href="#cb34-25"></a>  y&lt;-<span class="kw">rnorm</span>(n[i],<span class="dv">0</span>,sigma2)</span>
<span id="cb34-26"><a href="#cb34-26"></a>  Ftest&lt;-<span class="kw">var.test</span>(x,y,<span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb34-27"><a href="#cb34-27"></a>  Ftest<span class="op">$</span>p.value</span>
<span id="cb34-28"><a href="#cb34-28"></a>})</span>
<span id="cb34-29"><a href="#cb34-29"></a></span>
<span id="cb34-30"><a href="#cb34-30"></a>  Fpower[i]&lt;-<span class="kw">mean</span>(pvalues<span class="op">&lt;=</span><span class="fl">0.055</span>)</span>
<span id="cb34-31"><a href="#cb34-31"></a>}</span>
<span id="cb34-32"><a href="#cb34-32"></a></span>
<span id="cb34-33"><a href="#cb34-33"></a><span class="kw">print</span>(CFpower)</span></code></pre></div>
<pre><code>## [1] 0.3136 0.9902 1.0000</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">print</span>(Fpower)</span></code></pre></div>
<pre><code>## [1] 0.416 1.000 1.000</code></pre>
<p>上面分别为小样本、中样本和大样本的Count Five检验和F检验的功效，其中小样本选取20，中样本选取500，大样本选取10000 可以看出在检验两个方差不等的正态分布时，小样本的情况下F检验功效更高 ，样本足够大时，两者检验功效皆为1。</p>
</div>
<div id="question-6.c" class="section level2">
<h2>Question 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(β_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\]</span> Under normality, <span class="math inline">\(β_{1,d}= 0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n ((X_i-\bar{X})^T\hat{\Sigma}^{-1}((X_j-\bar{X}))^3\]</span> where $^{-1} $is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with d(d + 1)(d + 2)/6 degrees of freedom.</p>
</div>
<div id="answer-6.c" class="section level2">
<h2>Answer 6.C</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">set.seed</span>(<span class="dv">104</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a>sk&lt;-<span class="cf">function</span>(x){</span>
<span id="cb38-3"><a href="#cb38-3"></a>  m1&lt;-x</span>
<span id="cb38-4"><a href="#cb38-4"></a>  inv_sigma&lt;-<span class="kw">solve</span>(<span class="kw">cov</span>(<span class="kw">t</span>(x)))</span>
<span id="cb38-5"><a href="#cb38-5"></a>  m1[<span class="dv">1</span>,]&lt;-m1[<span class="dv">1</span>,]<span class="op">-</span><span class="kw">mean</span>(m1[<span class="dv">1</span>,])</span>
<span id="cb38-6"><a href="#cb38-6"></a>  m1[<span class="dv">2</span>,]&lt;-m1[<span class="dv">2</span>,]<span class="op">-</span><span class="kw">mean</span>(m1[<span class="dv">2</span>,])</span>
<span id="cb38-7"><a href="#cb38-7"></a>  m3&lt;-(<span class="kw">t</span>(m1)<span class="op">%*%</span>inv_sigma<span class="op">%*%</span>m1)<span class="op">^</span><span class="dv">3</span></span>
<span id="cb38-8"><a href="#cb38-8"></a>  <span class="kw">return</span>(<span class="kw">mean</span>(m3))</span>
<span id="cb38-9"><a href="#cb38-9"></a>}</span>
<span id="cb38-10"><a href="#cb38-10"></a>d&lt;-<span class="dv">2</span></span>
<span id="cb38-11"><a href="#cb38-11"></a>n&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb38-12"><a href="#cb38-12"></a>cv1&lt;-<span class="kw">qchisq</span>(<span class="fl">0.975</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb38-13"><a href="#cb38-13"></a>cv2&lt;-<span class="kw">qchisq</span>(<span class="fl">0.025</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb38-14"><a href="#cb38-14"></a>p.reject&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb38-15"><a href="#cb38-15"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb38-16"><a href="#cb38-16"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb38-17"><a href="#cb38-17"></a>  sktests&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb38-18"><a href="#cb38-18"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb38-19"><a href="#cb38-19"></a>    x&lt;-<span class="kw">rnorm</span>(n[i])</span>
<span id="cb38-20"><a href="#cb38-20"></a>    y&lt;-<span class="kw">rnorm</span>(n[i])</span>
<span id="cb38-21"><a href="#cb38-21"></a>    x0&lt;-<span class="kw">rbind</span>(x,y)</span>
<span id="cb38-22"><a href="#cb38-22"></a>    sktests[j]&lt;-<span class="kw">as.integer</span>((n[i]<span class="op">*</span><span class="kw">sk</span>(x0)<span class="op">/</span><span class="dv">6</span>)<span class="op">&gt;=</span>cv1 <span class="op">|</span><span class="st"> </span>(n[i]<span class="op">*</span><span class="kw">sk</span>(x0)<span class="op">/</span><span class="dv">6</span>)<span class="op">&lt;=</span>cv2)</span>
<span id="cb38-23"><a href="#cb38-23"></a>  }</span>
<span id="cb38-24"><a href="#cb38-24"></a>  p.reject[i]&lt;-<span class="kw">mean</span>(sktests)</span>
<span id="cb38-25"><a href="#cb38-25"></a>}</span>
<span id="cb38-26"><a href="#cb38-26"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.1041 0.0687 0.0629 0.0556 0.0543 0.0449</code></pre>
<p>模拟结果如上，分别为n=10,20,30,50,100,500时的第一类错误率的经验估计，可以看出当样本变大时，这些估计值接近理论水平α=0.05.</p>
</div>
<div id="question-discussion" class="section level2">
<h2>Question Discussion</h2>
<p>1.If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>2.What is the corresponding hypothesis test problem?</p>
<p>3.What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p>4.What information is needed to test your hypothesis?</p>
</div>
<div id="answer-discussion" class="section level2">
<h2>Answer Discussion</h2>
<p>1.No, we can’t.</p>
<p>2.Test null hypothesis H0 : t1e rate1= t1e rate2</p>
<p>3.MCNemar test,because other tests need independence.</p>
<p>4.Sample distribution.</p>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>Homework 6</h1>
<div id="question-7.1" class="section level2">
<h2>Question 7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-7.1" class="section level2">
<h2>Answer 7.1</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">data</span>(law,<span class="dt">package=</span><span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a>n&lt;-<span class="kw">nrow</span>(law)</span>
<span id="cb40-3"><a href="#cb40-3"></a>LSAT&lt;-law<span class="op">$</span>LSAT</span>
<span id="cb40-4"><a href="#cb40-4"></a>GPA&lt;-law<span class="op">$</span>GPA</span>
<span id="cb40-5"><a href="#cb40-5"></a>theta.hat&lt;-<span class="kw">cor</span>(LSAT,GPA)</span>
<span id="cb40-6"><a href="#cb40-6"></a></span>
<span id="cb40-7"><a href="#cb40-7"></a></span>
<span id="cb40-8"><a href="#cb40-8"></a>theta.jack&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb40-9"><a href="#cb40-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb40-10"><a href="#cb40-10"></a>  theta.jack[i]&lt;-<span class="kw">cor</span>(LSAT[<span class="op">-</span>i],GPA[<span class="op">-</span>i])</span>
<span id="cb40-11"><a href="#cb40-11"></a>}</span>
<span id="cb40-12"><a href="#cb40-12"></a>bias&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb40-13"><a href="#cb40-13"></a><span class="kw">print</span>(bias)</span></code></pre></div>
<pre><code>## [1] -0.006473623</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>se&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.1425186</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias=</span>bias,<span class="dt">se=</span>se),<span class="dv">8</span>)</span></code></pre></div>
<pre><code>##        bias          se 
## -0.00647362  0.14251862</code></pre>
</div>
<div id="question-7.5" class="section level2">
<h2>Question 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures 1/λ by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-7.5" class="section level2">
<h2>Answer 7.5</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">library</span>(fitdistrplus)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;fitdistrplus&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：MASS</code></pre>
<pre><code>## 载入需要的程辑包：survival</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;boot&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     aml</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a></span>
<span id="cb54-3"><a href="#cb54-3"></a>theta.boot&lt;-<span class="cf">function</span>(dat,i){</span>
<span id="cb54-4"><a href="#cb54-4"></a>  lambda&lt;-<span class="kw">fitdist</span>(dat[i],<span class="dt">distr=</span><span class="st">&quot;exp&quot;</span>,<span class="dt">method=</span><span class="st">&quot;mle&quot;</span>)<span class="op">$</span>estimate</span>
<span id="cb54-5"><a href="#cb54-5"></a>  <span class="dv">1</span><span class="op">/</span>lambda</span>
<span id="cb54-6"><a href="#cb54-6"></a>}</span>
<span id="cb54-7"><a href="#cb54-7"></a><span class="kw">data</span>(aircondit,<span class="dt">package =</span> <span class="st">&quot;boot&quot;</span>)</span>
<span id="cb54-8"><a href="#cb54-8"></a>dat&lt;-aircondit<span class="op">$</span>hours</span>
<span id="cb54-9"><a href="#cb54-9"></a>boot.obj&lt;-<span class="kw">boot</span>(dat,<span class="dt">statistic=</span>theta.boot,<span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb54-10"><a href="#cb54-10"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.6, 182.4 )   ( 29.3, 168.9 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.3, 186.8 )   ( 56.5, 236.6 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-7.8" class="section level2">
<h2>Answer 7.8</h2>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">data</span>(scor,<span class="dt">package=</span><span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a>n&lt;-<span class="kw">nrow</span>(scor)</span>
<span id="cb56-3"><a href="#cb56-3"></a>scor.cov&lt;-<span class="kw">cov</span>(scor)</span>
<span id="cb56-4"><a href="#cb56-4"></a>ev&lt;-<span class="kw">eigen</span>(scor.cov)</span>
<span id="cb56-5"><a href="#cb56-5"></a>val&lt;-ev<span class="op">$</span>values</span>
<span id="cb56-6"><a href="#cb56-6"></a>theta.hat&lt;-val[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(val)</span>
<span id="cb56-7"><a href="#cb56-7"></a></span>
<span id="cb56-8"><a href="#cb56-8"></a>theta.jack&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb56-9"><a href="#cb56-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb56-10"><a href="#cb56-10"></a>  scor.cov.jack&lt;-<span class="kw">cov</span>(scor[<span class="op">-</span>i,])</span>
<span id="cb56-11"><a href="#cb56-11"></a>  ev.jack&lt;-<span class="kw">eigen</span>(scor.cov.jack)</span>
<span id="cb56-12"><a href="#cb56-12"></a>  val.jack&lt;-ev.jack<span class="op">$</span>values</span>
<span id="cb56-13"><a href="#cb56-13"></a>  theta.jack[i]&lt;-val.jack[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(val.jack)</span>
<span id="cb56-14"><a href="#cb56-14"></a>}</span>
<span id="cb56-15"><a href="#cb56-15"></a>bias&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)</span>
<span id="cb56-16"><a href="#cb56-16"></a><span class="kw">print</span>(bias)</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>se&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="kw">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias=</span>bias,<span class="dt">se=</span>se),<span class="dv">8</span>)</span></code></pre></div>
<pre><code>##       bias         se 
## 0.00106914 0.04955231</code></pre>
</div>
<div id="question-7.11" class="section level2">
<h2>Question 7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-7.11" class="section level2">
<h2>Answer 7.11</h2>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     lung</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">attach</span>(ironslag)</span>
<span id="cb70-2"><a href="#cb70-2"></a>n&lt;-<span class="kw">length</span>(magnetic)</span>
<span id="cb70-3"><a href="#cb70-3"></a>e1&lt;-e2&lt;-e3&lt;-e4&lt;-<span class="kw">matrix</span>(<span class="dt">nrow=</span>n,<span class="dt">ncol=</span>n<span class="dv">-1</span>)</span>
<span id="cb70-4"><a href="#cb70-4"></a></span>
<span id="cb70-5"><a href="#cb70-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb70-6"><a href="#cb70-6"></a>  y0&lt;-magnetic[<span class="op">-</span>i]</span>
<span id="cb70-7"><a href="#cb70-7"></a>  x0&lt;-chemical[<span class="op">-</span>i]</span>
<span id="cb70-8"><a href="#cb70-8"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb70-9"><a href="#cb70-9"></a>    y&lt;-y0[<span class="op">-</span>k]</span>
<span id="cb70-10"><a href="#cb70-10"></a>    x&lt;-x0[<span class="op">-</span>k]</span>
<span id="cb70-11"><a href="#cb70-11"></a>    </span>
<span id="cb70-12"><a href="#cb70-12"></a>    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb70-13"><a href="#cb70-13"></a>    yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb70-14"><a href="#cb70-14"></a>    e1[i,k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</span>
<span id="cb70-15"><a href="#cb70-15"></a>    </span>
<span id="cb70-16"><a href="#cb70-16"></a>    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb70-17"><a href="#cb70-17"></a>    yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></span>
<span id="cb70-18"><a href="#cb70-18"></a><span class="st">      </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb70-19"><a href="#cb70-19"></a>    e2[i,k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</span>
<span id="cb70-20"><a href="#cb70-20"></a>    </span>
<span id="cb70-21"><a href="#cb70-21"></a>    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb70-22"><a href="#cb70-22"></a>    logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb70-23"><a href="#cb70-23"></a>    yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb70-24"><a href="#cb70-24"></a>    e3[i,k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</span>
<span id="cb70-25"><a href="#cb70-25"></a>    </span>
<span id="cb70-26"><a href="#cb70-26"></a>    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb70-27"><a href="#cb70-27"></a>    logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</span>
<span id="cb70-28"><a href="#cb70-28"></a>    yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb70-29"><a href="#cb70-29"></a>    e4[i,k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</span>
<span id="cb70-30"><a href="#cb70-30"></a>  }</span>
<span id="cb70-31"><a href="#cb70-31"></a>}</span></code></pre></div>
<p>The following estimates for prediction error are obtained from the leave-two-out cross validation.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 18.05558 15.68710 16.67263 18.71088</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>)</span>
<span id="cb73-2"><a href="#cb73-2"></a>L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb73-4"><a href="#cb73-4"></a>yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></span>
<span id="cb73-5"><a href="#cb73-5"></a><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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z6fvtjnV4ITbr9znpzNBbjgg5Mar3DFIAvI+g6zbUX3BvE+crO6fgR+xZihww5c8Qm68KgJItndnqxc2hx3P43M/MZCnQSI/rYnfTSPYATd+LQZotDmwUTHa7ac5913u2sFX/VkfoKAmJuRa11Km0Xr9mJm2nuUxeShbXRMDUdEEZO+ku988+PzUZuDx9PWtj/UFadCvGhDtX+t5mSKnH2XicaN3raebP6lT9Y/Mul6Mn7A1uu636l2nn7OJ2414XKOAs56Bov4ua9/YvrPhz5e2ho5a5oBxBy4/honTjbHLezp+0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgVQHyPx3GujfPA2U8uiBAuT4SJwIEtBJAtciWP+y+38qElVqmru63f9u1G3vxrmRRd3n1XWrLjQCSzyd9POx44nP3j+dI7bciof7+mSfQCRadpcibktu3AEjkxKu/++0b+bq5fxaJZN1/bzgLbfnNO5ljdxuAVJKqKG37n0yXU+mX6j/xuG4jnbU5t7uCWgegLklVA+oWYrMAUumsbSi6//eN16DTmc2oBukdtwHoHIMkIF3qESBlKRP6b6aJif7o+LRRgMTrU9X93McEpCxl5RG/1bgJQHocpEY2/HVbScaA1DhIJPa2CG8F0HpFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wN1MUdLdRK+nAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>L2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>The fitted regression equation for Model 2 is <span class="math display">\[\hat{Y}=24.49262-1.39334X+0.05452X^2\]</span></p>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<div id="question-8.3" class="section level2">
<h2>Question 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-8.3" class="section level2">
<h2>Answer 8.3</h2>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a>maxout&lt;-<span class="cf">function</span>(x,y) {</span>
<span id="cb76-3"><a href="#cb76-3"></a> X&lt;-x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb76-4"><a href="#cb76-4"></a> Y&lt;-y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb76-5"><a href="#cb76-5"></a> outx&lt;-<span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb76-6"><a href="#cb76-6"></a> outy&lt;-<span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb76-7"><a href="#cb76-7"></a> <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</span>
<span id="cb76-8"><a href="#cb76-8"></a>}</span>
<span id="cb76-9"><a href="#cb76-9"></a></span>
<span id="cb76-10"><a href="#cb76-10"></a>R&lt;-<span class="dv">999</span></span>
<span id="cb76-11"><a href="#cb76-11"></a>n1&lt;-<span class="dv">20</span></span>
<span id="cb76-12"><a href="#cb76-12"></a>n2&lt;-<span class="dv">30</span></span>
<span id="cb76-13"><a href="#cb76-13"></a>mu1&lt;-mu2&lt;-<span class="dv">0</span></span>
<span id="cb76-14"><a href="#cb76-14"></a>sigma1&lt;-sigma2&lt;-<span class="dv">1</span></span>
<span id="cb76-15"><a href="#cb76-15"></a>x&lt;-<span class="kw">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb76-16"><a href="#cb76-16"></a>y&lt;-<span class="kw">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb76-17"><a href="#cb76-17"></a>z&lt;-<span class="kw">c</span>(x,y)</span>
<span id="cb76-18"><a href="#cb76-18"></a>K&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">50</span></span>
<span id="cb76-19"><a href="#cb76-19"></a>reps&lt;-<span class="kw">numeric</span>(R)</span>
<span id="cb76-20"><a href="#cb76-20"></a>t0&lt;-<span class="kw">maxout</span>(x,y)</span>
<span id="cb76-21"><a href="#cb76-21"></a></span>
<span id="cb76-22"><a href="#cb76-22"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb76-23"><a href="#cb76-23"></a>  k&lt;-<span class="kw">sample</span>(K,<span class="dt">size=</span><span class="dv">20</span>,<span class="dt">replace=</span><span class="ot">FALSE</span>)</span>
<span id="cb76-24"><a href="#cb76-24"></a>  x1&lt;-z[k]</span>
<span id="cb76-25"><a href="#cb76-25"></a>  y1&lt;-z[<span class="op">-</span>k]</span>
<span id="cb76-26"><a href="#cb76-26"></a>  reps[i]&lt;-<span class="kw">maxout</span>(x1,y1)</span>
<span id="cb76-27"><a href="#cb76-27"></a>}</span>
<span id="cb76-28"><a href="#cb76-28"></a>p&lt;-<span class="kw">mean</span>(<span class="kw">c</span>(t0,reps)<span class="op">&gt;</span><span class="dv">5</span>)</span>
<span id="cb76-29"><a href="#cb76-29"></a>p</span></code></pre></div>
<pre><code>## [1] 0.099</code></pre>
<p>Construct two normal distribution, one with 20 samples, the other with 30 samples. And they are all the same distribution.</p>
<p>The p value is 0.099, The ASL is 0.198 so the null hypothesis is not rejected. Hence the test is available.</p>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p>1.Unequal variances and equal expectations</p>
<p>2.Unequal variances and unequal expectations</p>
<p>3.Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>4.Unbalanced samples (say, 1 case versus 10 controls)</p>
<p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">library</span>(RANN)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="kw">library</span>(energy)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">library</span>(Ball)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb84-2"><a href="#cb84-2"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb84-3"><a href="#cb84-3"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb84-4"><a href="#cb84-4"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb84-5"><a href="#cb84-5"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb84-6"><a href="#cb84-6"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb84-7"><a href="#cb84-7"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb84-8"><a href="#cb84-8"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb84-9"><a href="#cb84-9"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb84-10"><a href="#cb84-10"></a>}</span>
<span id="cb84-11"><a href="#cb84-11"></a></span>
<span id="cb84-12"><a href="#cb84-12"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb84-13"><a href="#cb84-13"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">30</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb84-14"><a href="#cb84-14"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb84-15"><a href="#cb84-15"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb84-16"><a href="#cb84-16"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb84-17"><a href="#cb84-17"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb84-18"><a href="#cb84-18"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb84-19"><a href="#cb84-19"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb84-20"><a href="#cb84-20"></a>}</span>
<span id="cb84-21"><a href="#cb84-21"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span></code></pre></div>
<p>1.Unequal variances and equal expectations n1=n2=30; mu1=mu2=0; sigma1=1, sigma2=1.5</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb85-2"><a href="#cb85-2"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb85-3"><a href="#cb85-3"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb85-4"><a href="#cb85-4"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb85-5"><a href="#cb85-5"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb85-6"><a href="#cb85-6"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb85-7"><a href="#cb85-7"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb85-8"><a href="#cb85-8"></a>}</span>
<span id="cb85-9"><a href="#cb85-9"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb85-10"><a href="#cb85-10"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb85-11"><a href="#cb85-11"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">NN=</span>pow[<span class="dv">1</span>],<span class="dt">Energy=</span>pow[<span class="dv">2</span>],<span class="dt">Ball=</span>pow[<span class="dv">3</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     NN Energy   Ball 
##  0.322  0.358  0.772</code></pre>
<p>We can see that Ball test could be more powerful than other two tests, and Energy test is slightly powerful than nearest NN test.</p>
<ol start="2" style="list-style-type: decimal">
<li>n1=n2=30; mu1=0,mu2=0.3; sigma1=1, sigma2=1.5</li>
</ol>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb87-2"><a href="#cb87-2"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb87-3"><a href="#cb87-3"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="fl">0.3</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb87-4"><a href="#cb87-4"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb87-5"><a href="#cb87-5"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb87-6"><a href="#cb87-6"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb87-7"><a href="#cb87-7"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb87-8"><a href="#cb87-8"></a>}</span>
<span id="cb87-9"><a href="#cb87-9"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb87-10"><a href="#cb87-10"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb87-11"><a href="#cb87-11"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">NN=</span>pow[<span class="dv">1</span>],<span class="dt">Energy=</span>pow[<span class="dv">2</span>],<span class="dt">Ball=</span>pow[<span class="dv">3</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     NN Energy   Ball 
##  0.405  0.549  0.824</code></pre>
<p>We can see that Ball test could be more powerful than other two tests,and Energy test is more powerful than nearest NN test.</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb89-2"><a href="#cb89-2"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb89-3"><a href="#cb89-3"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="fl">0.5</span>))</span>
<span id="cb89-4"><a href="#cb89-4"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb89-5"><a href="#cb89-5"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb89-6"><a href="#cb89-6"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb89-7"><a href="#cb89-7"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb89-8"><a href="#cb89-8"></a>}</span>
<span id="cb89-9"><a href="#cb89-9"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb89-10"><a href="#cb89-10"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb89-11"><a href="#cb89-11"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">NN=</span>pow[<span class="dv">1</span>],<span class="dt">Energy=</span>pow[<span class="dv">2</span>],<span class="dt">Ball=</span>pow[<span class="dv">3</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     NN Energy   Ball 
##  0.724  0.975  0.988</code></pre>
<p>We can see that Ball test and Energy test are more powerful than nearest NN test, and they are close to 1.</p>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<div id="question-9.4" class="section level2">
<h2>Question 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-9.4" class="section level2">
<h2>Answer 9.4</h2>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb91-2"><a href="#cb91-2"></a>f&lt;-<span class="cf">function</span>(x){</span>
<span id="cb91-3"><a href="#cb91-3"></a>  <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb91-4"><a href="#cb91-4"></a>}</span>
<span id="cb91-5"><a href="#cb91-5"></a></span>
<span id="cb91-6"><a href="#cb91-6"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb91-7"><a href="#cb91-7"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb91-8"><a href="#cb91-8"></a>x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb91-9"><a href="#cb91-9"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb91-10"><a href="#cb91-10"></a>k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb91-11"><a href="#cb91-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb91-12"><a href="#cb91-12"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb91-13"><a href="#cb91-13"></a><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb91-14"><a href="#cb91-14"></a>x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb91-15"><a href="#cb91-15"></a>x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb91-16"><a href="#cb91-16"></a>k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb91-17"><a href="#cb91-17"></a>} }</span>
<span id="cb91-18"><a href="#cb91-18"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb91-19"><a href="#cb91-19"></a>}</span></code></pre></div>
<p>Four chains are generated for different variances σ2 of the proposal distribution.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb92-2"><a href="#cb92-2"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb92-3"><a href="#cb92-3"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">sigma1=</span>sigma[<span class="dv">1</span>],<span class="dt">sigma2=</span>sigma[<span class="dv">2</span>],<span class="dt">sigma3=</span>sigma[<span class="dv">3</span>],<span class="dt">sigma4=</span>sigma[<span class="dv">4</span>]),<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## sigma1 sigma2 sigma3 sigma4 
##    0.5    1.0    2.0    4.0</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb94-2"><a href="#cb94-2"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb94-3"><a href="#cb94-3"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb94-4"><a href="#cb94-4"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb94-5"><a href="#cb94-5"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb94-6"><a href="#cb94-6"></a></span>
<span id="cb94-7"><a href="#cb94-7"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb94-8"><a href="#cb94-8"></a><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</span></code></pre></div>
<pre><code>## [1]  349  602  958 1314</code></pre>
<p>We can see the 1st,2nd and 3rd chain has a rejection rate in the range [0.15, 0.5]. Acceptance rates：</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">sigma1=</span><span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N,<span class="dt">sigma2=</span><span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N,<span class="dt">sigma3=</span><span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N,<span class="dt">sigma4=</span><span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## sigma1 sigma2 sigma3 sigma4 
## 0.8255 0.6990 0.5210 0.3430</code></pre>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span> &lt; 1.2.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>Use the Gelman-Rubin method to monitor convergence of the chain of Exercise 9.4</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb98-2"><a href="#cb98-2"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb98-3"><a href="#cb98-3"></a></span>
<span id="cb98-4"><a href="#cb98-4"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb98-5"><a href="#cb98-5"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb98-6"><a href="#cb98-6"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb98-7"><a href="#cb98-7"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) </span>
<span id="cb98-8"><a href="#cb98-8"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)</span>
<span id="cb98-9"><a href="#cb98-9"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) </span>
<span id="cb98-10"><a href="#cb98-10"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)</span>
<span id="cb98-11"><a href="#cb98-11"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)</span>
<span id="cb98-12"><a href="#cb98-12"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W</span>
<span id="cb98-13"><a href="#cb98-13"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb98-14"><a href="#cb98-14"></a>}</span>
<span id="cb98-15"><a href="#cb98-15"></a></span>
<span id="cb98-16"><a href="#cb98-16"></a>k &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb98-17"><a href="#cb98-17"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span></span>
<span id="cb98-18"><a href="#cb98-18"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb98-19"><a href="#cb98-19"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb98-20"><a href="#cb98-20"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb98-21"><a href="#cb98-21"></a>  X[i, ] &lt;-<span class="kw">rw.Metropolis</span>(sigma[i], x0, n)<span class="op">$</span>x</span>
<span id="cb98-22"><a href="#cb98-22"></a></span>
<span id="cb98-23"><a href="#cb98-23"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb98-24"><a href="#cb98-24"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb98-25"><a href="#cb98-25"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb98-26"><a href="#cb98-26"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.126156</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb100-2"><a href="#cb100-2"></a>  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb100-3"><a href="#cb100-3"></a>       <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZmY6ZpA6ZrY6kNtmAABmZmZmtv+QOgCQOjqQZgCQZjqQZpCQtraQ2/+2ZgC22/+2///bkDrb2//b////tmb/25D/27b//7b//9v////krpaLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGnklEQVR4nO2di3bTOBQAzRb2TaH7IkuWlMb//4/b+BU3iTWSa8dKPXOA41L52hmkK8m5pEUpQYqlbyB3FAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBgYkHFzbCUoGnDzYeCAAUBCwvK39OyguJT4GLYg4BZBD3df3z+c/c8R/7wNRxuzYK2d98OR5+D4VYsqFFTaRoOt2JBjx8qQbuBQaYge1CAp/vDJuZ92abr4XArFVRWjt59eZ7IBvwoKDKcgiCcgrbOYmmXO3kOpSAIpyAIt1pB+4d6ILlZvcy2Xf8MLoTWLWj/0Glxq3GJ3kMON6uXsAcR26LpQuagAer9fFEM9B8FxYZTEITL/32fpd9ZVRCEUxCEUxCEUxCEUxCEUxCEUxCEUxCEU9BJlNPiUQVBOAVBOAVBuOx3qwoCFAQoCFhaUPaGFAQsLij3iV5BwJyCdsWhTpHCrVPQpig+Pv7yDSvtkwNfnVRB+7+H3grss7n7Vm6q3gNvPafcwTKkCnq6f/frp3/+C7et+s3jjwdBULyQcgfLkDzEvv/1c1EUvwfb1uXj+4PG1fWgmu9/DBWI13S1rVRpn3IHyzAySR8ScIhtPX3tioEc/XYFtWUbofrDtOu+MUEN1IMSwr1JQftNOAcdgUr7lDtYhpGz2G8jO9CFT3zIfLc6bh3075TXTfh8jAWYZyWddN23JSiS2Er76nCFgqIr7avD9QmKr5OuD1cnKL7SPj32tcmgB61QUHyl/YjYV2amWSy20n5M7Ouy/EP7Mu/FdBaCcu5CCgIUBGQkKE9LCgIUBOQjKNO5XkGAgoArCxr4FOLnL3N9KpRJD0r65OarkoegUkEQLt8xlo+gTLN0RoLyXClmImiOS0yDggAFAXkJajNRRvk6Q0HVlD/t1V5BVoKKRlBOq8YcBVW/pr3ceGZ66/m4KY1567n9u241dMxGizNPD9o/UIXnxXC95WIxrqZheqczDbH9w/sx4XqCRuWh8CmjEttcOWi4QjoUrrdlHSMIThklPack/UJQu8NPeUn9UdksFurf7cw4YgGRmaCX9a9xD9JOTyh7SormOcoxUKqjzAWV3T/7wPVfrAiO68yiy2SnPlLH2dyCuJD85V+fCir7I+Ry+37v6EK0mexSam5bR72kK/eggYf2ve+/uGT3QobOKXoDsZffY28j5o4j2qQ1nC5cO3qOubb+sueh11eSsnm3aJ/kRtMaTheuP6M1X/df1omgpKt3JyVMAVM1rEgpJB++5IXsUfZ70qu3bO04C4SZR1BSIXnKNZuNWpuVpujXZ+mojZ5wo0kNy/Qy4HiKY1YuE/POcMzyxezZim/7aUqYWFILyRNobv44v01GbyosipkFzdeDTrZoU88cF7rkXDkoqZA8Z2aaxdIKyXMm53VQFigIWEzQzbCQoGDQgWchr288xfWGUBCgIEBBgIIABQEKAhQEKAi4mb3BUigIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEHA9IJCPzShYVO9M9s1PD8I8fjT18snpYWJZXJBu+d724Xvb1e9dd01PD8I8XRfFZYEzo4KE83UguoKkE3ofyw83R8EdQ3PD0Ls6vK2wNlRYeKZWtDjh0MByFCVcMX27s9nQV3D84NA+F3xsSpNCpwdEyaByQUFf6pE0+KQg7qG5wfhK9SChs+ODBPL1ILqwR9IAYcRcBDUNTw/gCscXnrg7MgwsVxd0KE2bc2CqINX31/zEKMUuW2qTz6Pzq43nqSjJtnN+Gm+EXS703zUMm3zioViM3hudqFYDaK4rUbX8PwgRJNdAmdHhYnFzSqgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBQO6Cqg8mHPi4q6uQuaD9w7sv5baYqpZlBJkLmrgaagSZC6qZrtonnZsQtLEHBRn8UMJrcAOCdkvm6BsQtGj/uQFB22X9ZC9oCz/IY3YyF/T4Ydn+k72gpjDfdVC+KAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAv4H0CddgJXGRCYAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb101-3"><a href="#cb101-3"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb101-4"><a href="#cb101-4"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb101-5"><a href="#cb101-5"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAS1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmtv+QOgCQZgCQ2/+2ZgC2///bkDrbkJDb////tmb/25D//7b//9v///9EENJEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAF1klEQVR4nO3db3eaSBxAYZqku5vUjWFrot//k6780Z5WmTsQBn7Ge98sp4uDec4AkihWB0tWrf0EoicQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNDNQdTOtBTTvcOUSCBIIKgS033Q78MNbcrgbYCoDVFfP3cLutDAwXHyhIkD7zZmlfvyZGu5OgT5efpwWdwM72X0DOYOouuqnkMeggT5eurPYwPwRKHc4gWA4gWo4i4UXWngGXVwkCwTDCQTD3StQfdyJ2pdCcAy6V6D62+vxpdDTQaDrdZca+83xZaJA1zpdrG4ffyJQdKGyF6vbJwIKP4UKHYN6luMlmUBXO13O7zcCfXK7AsFwAsFw0U9jqwNFn0ICQQJBAkEBgGILrQ8UfAoJBAkErf1L+9lGLlWEGRRaKABQ7CkkECQQFAIoslAEoNBTSCBIIEggKAZQYKEQQJGnUCGg7cPb4f17VX17zRru7oBan79ef3tLeWq4wPtYoTcvPDd/l28W4Y3kU0Zftk8A/Tf0SZ523vRvYICPIox+Gos3GqjuP+M0+Ff3pmb21KNmUFihsUC742F3e/yhd9XQhwyaPl4e3toptBs6Sv+53a8CtN88tXtQPXx+6tp1vzd8yt3uVwFqD7/7zT/DP/nE7Ybdx0YDNaftbWr3mrjdrwU0+CGei/AteKOfyMJNA5q8gw1/Xj/qPrYwUGK7AsF2g06h0UC/dpLEC8VJ2/0SQCW3G3MKFbpYxXl2bbj7AUpfqA0OF3IKFdrF2kuS0cPdEdDxWmzgN2Wp4SJOoUAH6fk3MkfBgOIJxQIKKBQMKN5OFg4omlA0oHBC4YCiCcUDCnYYiggUSiggUCyhiEChhEICRRJaGCj3JrtxhGLOoEBCUYEOI+7kXLSwQFEmUWCgGEKRgULsZqGBIkyi4EDrT6LoQKsTxQdaeT+7BaBVJ9FNAHWXKPM+gewtz75iW/aNJvNbiagMUP6NJse0yjQqAjTiRpMjW56o0Ntfsm80ObpRX0g0QwVn0CHrRpNTWtKo0DEo/0aTE1tsIhU7i+XeaPITLYJ0I6+DhscpjXTrQO1YJZVKAxU5SF8dsJDSan/V6H+cef9bYtxlgUoN9/vYWX9Zyh1s9hVXGe7qJmZx+sJApy1l/q1y6OGzr7jKcFmbnCRV6Frs15NZ6iw2oj/OE7By9qhjnsK0jyKs0MVZ9XKN7KFGbXjaRxFWrqqueJU6Bk36KELE7uggPS2BIIGg1YBuppWAkoNe/+cZVp5je0MJBAkECQQJBAkECQQJBAkE3cy1wVoJBAkECQQJBAkECQQJBAkECQQJBAkECQTND7RLfO1GX3df5vOKlwup3v9+u/6gccPkNjtQc7v7wVve96tUDdB5xcuFVM199Q/JR2cNk93cQN3HFZL3Ff54aYDOK14upNp1b01KPDprmPzmBnr/3rz9Y+hdwm31479HoPOKlwuJ4XfVc/uVHolH5wwzotmBmm+2Gfxekn6N5hh0XvFyIb2FDmj40ZnD5DY3ULfzJw4BzR7QfoPHacXLBdhC86MnHp05TG6LAzXf6XLPQDTB2/9/z7sYHSLr/t0nPyYfXW/8IJ11kt1OP833QLd7ms96mbb9xAvFfue52ReK7U6Ud6lxXvFyIVV/dEk8OmuY3LxYhQSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIL+B5PizOFF2XC9AAAAAElFTkSuQmCC" /><!-- --></p>
<p>We can see that The value of <span class="math inline">\(\hat{R}\)</span> is less than 1. within time 7000.</p>
</div>
<div id="question-11.4" class="section level2">
<h2>Question 11.4</h2>
<p>Find the intersection points A(k) in (0, √k) of the curves <span class="math display">\[S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})\]</span> and <span class="math display">\[S_{k}(a)=P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}})\]</span> for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
</div>
<div id="answer-11.4" class="section level2">
<h2>Answer 11.4</h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>S&lt;-<span class="cf">function</span>(k,a){</span>
<span id="cb102-2"><a href="#cb102-2"></a>  <span class="kw">return</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k))</span>
<span id="cb102-3"><a href="#cb102-3"></a>}</span>
<span id="cb102-4"><a href="#cb102-4"></a>f&lt;-<span class="cf">function</span>(a){</span>
<span id="cb102-5"><a href="#cb102-5"></a>  <span class="kw">S</span>(k<span class="dv">-1</span>,a)<span class="op">-</span><span class="kw">S</span>(k,a)</span>
<span id="cb102-6"><a href="#cb102-6"></a>}</span></code></pre></div>
<p>k=25</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>k=<span class="dv">25</span></span>
<span id="cb103-2"><a href="#cb103-2"></a>solution &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">2</span>))</span>
<span id="cb103-3"><a href="#cb103-3"></a><span class="kw">unlist</span>(solution)</span></code></pre></div>
<pre><code>##          root        f.root          iter       init.it    estim.prec 
##  1.687374e+00 -7.070962e-09  7.000000e+00            NA  6.103516e-05</code></pre>
<p>k=100</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>k=<span class="dv">100</span></span>
<span id="cb105-2"><a href="#cb105-2"></a>solution &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">2</span>))</span>
<span id="cb105-3"><a href="#cb105-3"></a><span class="kw">unlist</span>(solution)</span></code></pre></div>
<pre><code>##          root        f.root          iter       init.it    estim.prec 
##  1.720606e+00 -9.560142e-11  8.000000e+00            NA  6.103516e-05</code></pre>
<p>k=500</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>k=<span class="dv">500</span></span>
<span id="cb107-2"><a href="#cb107-2"></a>solution &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">2</span>))</span>
<span id="cb107-3"><a href="#cb107-3"></a><span class="kw">unlist</span>(solution)</span></code></pre></div>
<pre><code>##          root        f.root          iter       init.it    estim.prec 
##  1.729753e+00 -4.180434e-12  8.000000e+00            NA  6.103516e-05</code></pre>
<p>k=1000</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>k=<span class="dv">1000</span></span>
<span id="cb109-2"><a href="#cb109-2"></a>solution &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">2</span>))</span>
<span id="cb109-3"><a href="#cb109-3"></a><span class="kw">unlist</span>(solution)</span></code></pre></div>
<pre><code>##          root        f.root          iter       init.it    estim.prec 
##  1.730905e+00 -1.055378e-12  8.000000e+00            NA  6.103516e-05</code></pre>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>Homework 9</h1>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>A-B-O blood type problem</p>
<p>Observed data: nA· = nAA + nAO = 444 (A-type), nB· = nBB + nBO = 132 (B-type), nOO = 361 (O-type), nAB = 63 (AB-type).</p>
<p>Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).</p>
<p>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<p>We can get that</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="kw">library</span>(nloptr)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;nloptr&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>eval_f0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>) {</span>
<span id="cb113-2"><a href="#cb113-2"></a>  </span>
<span id="cb113-3"><a href="#cb113-3"></a>  r1 =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x1)</span>
<span id="cb113-4"><a href="#cb113-4"></a>  nAA =<span class="st"> </span>n.A<span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">*</span>r1)</span>
<span id="cb113-5"><a href="#cb113-5"></a>  nBB =<span class="st"> </span>n.B<span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">*</span>r1)</span>
<span id="cb113-6"><a href="#cb113-6"></a>  r =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x)</span>
<span id="cb113-7"><a href="#cb113-7"></a>  <span class="kw">return</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">-</span></span>
<span id="cb113-8"><a href="#cb113-8"></a><span class="st">           </span>(n.A<span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>r)<span class="op">-</span>(n.B<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>r)<span class="op">-</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>x[<span class="dv">2</span>]))</span>
<span id="cb113-9"><a href="#cb113-9"></a>}</span>
<span id="cb113-10"><a href="#cb113-10"></a></span>
<span id="cb113-11"><a href="#cb113-11"></a></span>
<span id="cb113-12"><a href="#cb113-12"></a></span>
<span id="cb113-13"><a href="#cb113-13"></a>eval_g0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>) {</span>
<span id="cb113-14"><a href="#cb113-14"></a>  <span class="kw">return</span>(<span class="kw">sum</span>(x)<span class="op">-</span><span class="fl">0.999999</span>)</span>
<span id="cb113-15"><a href="#cb113-15"></a>}</span>
<span id="cb113-16"><a href="#cb113-16"></a></span>
<span id="cb113-17"><a href="#cb113-17"></a>opts =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;algorithm&quot;</span>=<span class="st">&quot;NLOPT_LN_COBYLA&quot;</span>,</span>
<span id="cb113-18"><a href="#cb113-18"></a>             <span class="st">&quot;xtol_rel&quot;</span>=<span class="fl">1.0e-8</span>)</span>
<span id="cb113-19"><a href="#cb113-19"></a>mle =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb113-20"><a href="#cb113-20"></a>r =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb113-21"><a href="#cb113-21"></a>r =<span class="st"> </span><span class="kw">rbind</span>(r,<span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.35</span>))<span class="co"># the beginning value of p0 and q0</span></span>
<span id="cb113-22"><a href="#cb113-22"></a>j =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb113-23"><a href="#cb113-23"></a><span class="cf">while</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(r[j,]<span class="op">-</span>r[j<span class="dv">-1</span>,]))<span class="op">&gt;</span><span class="fl">1e-8</span>) {</span>
<span id="cb113-24"><a href="#cb113-24"></a>res =<span class="st"> </span><span class="kw">nloptr</span>( <span class="dt">x0=</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.25</span>),</span>
<span id="cb113-25"><a href="#cb113-25"></a>               <span class="dt">eval_f=</span>eval_f0,</span>
<span id="cb113-26"><a href="#cb113-26"></a>               <span class="dt">lb =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">ub =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb113-27"><a href="#cb113-27"></a>               <span class="dt">eval_g_ineq =</span> eval_g0, </span>
<span id="cb113-28"><a href="#cb113-28"></a>               <span class="dt">opts =</span> opts, <span class="dt">x1=</span>r[j,],<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span> )</span>
<span id="cb113-29"><a href="#cb113-29"></a>j =<span class="st"> </span>j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb113-30"><a href="#cb113-30"></a>r =<span class="st"> </span><span class="kw">rbind</span>(r,res<span class="op">$</span>solution)</span>
<span id="cb113-31"><a href="#cb113-31"></a>mle =<span class="st"> </span><span class="kw">c</span>(mle,<span class="kw">eval_f0</span>(<span class="dt">x=</span>r[j,],<span class="dt">x1=</span>r[j<span class="dv">-1</span>,]))</span>
<span id="cb113-32"><a href="#cb113-32"></a>}</span>
<span id="cb113-33"><a href="#cb113-33"></a></span>
<span id="cb113-34"><a href="#cb113-34"></a>r </span></code></pre></div>
<pre><code>##            [,1]      [,2]
##  [1,] 0.0000000 0.0000000
##  [2,] 0.2000000 0.3500000
##  [3,] 0.2938636 0.1159800
##  [4,] 0.2977537 0.1034051
##  [5,] 0.2977020 0.1027454
##  [6,] 0.2976539 0.1027089
##  [7,] 0.2976433 0.1027065
##  [8,] 0.2976411 0.1027063
##  [9,] 0.2976407 0.1027063
## [10,] 0.2976407 0.1027063
## [11,] 0.2976407 0.1027063
## [12,] 0.2976407 0.1027063</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="co">#the max likelihood values</span></span>
<span id="cb115-2"><a href="#cb115-2"></a><span class="kw">plot</span>(<span class="op">-</span>mle,<span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<p>for loops:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb116-2"><a href="#cb116-2"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb116-3"><a href="#cb116-3"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb116-4"><a href="#cb116-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb116-5"><a href="#cb116-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb116-6"><a href="#cb116-6"></a>)</span>
<span id="cb116-7"><a href="#cb116-7"></a></span>
<span id="cb116-8"><a href="#cb116-8"></a>l&lt;-formulas</span>
<span id="cb116-9"><a href="#cb116-9"></a></span>
<span id="cb116-10"><a href="#cb116-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb116-11"><a href="#cb116-11"></a>  l[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]],mtcars)</span>
<span id="cb116-12"><a href="#cb116-12"></a>}</span>
<span id="cb116-13"><a href="#cb116-13"></a></span>
<span id="cb116-14"><a href="#cb116-14"></a>l</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>lapply():</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb118-2"><a href="#cb118-2"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb118-3"><a href="#cb118-3"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb118-4"><a href="#cb118-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb118-5"><a href="#cb118-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb118-6"><a href="#cb118-6"></a>)</span>
<span id="cb118-7"><a href="#cb118-7"></a></span>
<span id="cb118-8"><a href="#cb118-8"></a><span class="kw">lapply</span>(formulas,<span class="cf">function</span>(formula) <span class="kw">lm</span>(formula,mtcars))</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb120-2"><a href="#cb120-2"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb120-3"><a href="#cb120-3"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb120-4"><a href="#cb120-4"></a>)</span>
<span id="cb120-5"><a href="#cb120-5"></a><span class="kw">sapply</span>(trials,<span class="cf">function</span>(trial) trial<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.178809502 0.994262402 0.064786264 0.952716251 0.306702525 0.198224877
##   [7] 0.272315768 0.283722503 0.415010770 0.151957272 0.072625558 0.249014108
##  [13] 0.773938569 0.225693023 0.840328179 0.987492066 0.316112244 0.481740992
##  [19] 0.457889571 0.565871989 0.990401857 0.257905112 0.538178810 0.764364559
##  [25] 0.845551784 0.905726387 0.086725138 0.763639767 0.088857796 0.531422351
##  [31] 0.731524606 0.195574176 0.598923896 0.702134266 0.147168770 0.552598436
##  [37] 0.117002585 0.233188724 0.127240002 0.115791872 0.317030411 0.691674119
##  [43] 0.450514119 0.315343567 0.073583503 1.000000000 0.011099981 0.580714657
##  [49] 0.591841839 0.638287091 0.283349660 0.722557025 0.408819857 0.127117578
##  [55] 0.000507563 0.841418067 0.624022112 0.650656602 0.632088219 0.578419158
##  [61] 0.052008307 0.920025002 0.646534041 0.344836350 0.751638828 0.687324041
##  [67] 0.134492519 0.490444844 0.711864108 0.020394691 0.342792908 0.960823950
##  [73] 0.111337525 0.546907007 0.773231299 0.626303636 0.298304108 0.146218612
##  [79] 0.133931753 0.814393484 0.096839576 0.974929586 0.808056754 0.346709412
##  [85] 0.308443909 0.600935588 0.984471134 0.703069949 0.678262994 0.565803030
##  [91] 0.895621651 0.723438333 0.431024548 0.061331285 0.043636182 0.359298038
##  [97] 0.372409666 0.953012247 0.503028465 0.594358009</code></pre>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4</h2>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>x&lt;-<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dt">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb122-2"><a href="#cb122-2"></a>x</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    3    5    7    9
## [2,]    2    4    6    8   10</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a><span class="kw">vapply</span>(x,<span class="cf">function</span>(x) <span class="kw">as.vector</span>(x),<span class="kw">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
</div>
<div id="homework-10" class="section level1">
<h1>Homework 10</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</p>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
<p>Comments your results.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="kw">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<p>Rcpp function:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb128-2"><a href="#cb128-2"></a>using namespace Rcpp;</span>
<span id="cb128-3"><a href="#cb128-3"></a></span>
<span id="cb128-4"><a href="#cb128-4"></a>double <span class="kw">lap_f</span>(double x){</span>
<span id="cb128-5"><a href="#cb128-5"></a>  return <span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x));</span>
<span id="cb128-6"><a href="#cb128-6"></a>}</span>
<span id="cb128-7"><a href="#cb128-7"></a></span>
<span id="cb128-8"><a href="#cb128-8"></a></span>
<span id="cb128-9"><a href="#cb128-9"></a><span class="op">/</span><span class="er">/</span><span class="st"> </span>[[Rcpp<span class="op">::</span>export]]</span>
<span id="cb128-10"><a href="#cb128-10"></a></span>
<span id="cb128-11"><a href="#cb128-11"></a>NumericVector <span class="kw">MetropolisC</span>(double sigma, double x0, int N){</span>
<span id="cb128-12"><a href="#cb128-12"></a>  NumericVector <span class="kw">x</span>(N);</span>
<span id="cb128-13"><a href="#cb128-13"></a>  x[<span class="dv">0</span>] =<span class="st"> </span>x0;</span>
<span id="cb128-14"><a href="#cb128-14"></a>  NumericVector <span class="kw">u</span>(N);  </span>
<span id="cb128-15"><a href="#cb128-15"></a>  u =<span class="st"> </span><span class="kw">runif</span>(N);</span>
<span id="cb128-16"><a href="#cb128-16"></a>  int k =<span class="st"> </span><span class="dv">0</span>;</span>
<span id="cb128-17"><a href="#cb128-17"></a>  <span class="cf">for</span> (int <span class="dt">i =</span> <span class="dv">1</span>; i <span class="op">&lt;</span><span class="st"> </span>N; <span class="op">++</span>i){</span>
<span id="cb128-18"><a href="#cb128-18"></a>    NumericVector <span class="kw">y</span>(<span class="dv">1</span>);</span>
<span id="cb128-19"><a href="#cb128-19"></a>    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>],sigma);</span>
<span id="cb128-20"><a href="#cb128-20"></a>    <span class="cf">if</span> ( u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">lap_f</span>(y[<span class="dv">0</span>])<span class="op">/</span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>])) </span>
<span id="cb128-21"><a href="#cb128-21"></a>          x[i] =<span class="st"> </span>y[<span class="dv">0</span>] ;</span>
<span id="cb128-22"><a href="#cb128-22"></a>    <span class="cf">else</span>{</span>
<span id="cb128-23"><a href="#cb128-23"></a>          x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>];</span>
<span id="cb128-24"><a href="#cb128-24"></a>          k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span>;</span>
<span id="cb128-25"><a href="#cb128-25"></a>    }       </span>
<span id="cb128-26"><a href="#cb128-26"></a>  }</span>
<span id="cb128-27"><a href="#cb128-27"></a>  return x;</span>
<span id="cb128-28"><a href="#cb128-28"></a>} </span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb129-2"><a href="#cb129-2"></a>lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb129-3"><a href="#cb129-3"></a></span>
<span id="cb129-4"><a href="#cb129-4"></a>rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb129-5"><a href="#cb129-5"></a> x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb129-6"><a href="#cb129-6"></a> x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb129-7"><a href="#cb129-7"></a> u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb129-8"><a href="#cb129-8"></a> k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb129-9"><a href="#cb129-9"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb129-10"><a href="#cb129-10"></a>  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb129-11"><a href="#cb129-11"></a>  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </span>
<span id="cb129-12"><a href="#cb129-12"></a>  <span class="cf">else</span> {</span>
<span id="cb129-13"><a href="#cb129-13"></a>  x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb129-14"><a href="#cb129-14"></a>  k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb129-15"><a href="#cb129-15"></a>  }</span>
<span id="cb129-16"><a href="#cb129-16"></a> }</span>
<span id="cb129-17"><a href="#cb129-17"></a> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb129-18"><a href="#cb129-18"></a>}</span>
<span id="cb129-19"><a href="#cb129-19"></a></span>
<span id="cb129-20"><a href="#cb129-20"></a></span>
<span id="cb129-21"><a href="#cb129-21"></a>dir_cpp &lt;-<span class="st"> &#39;../src/&#39;</span></span>
<span id="cb129-22"><a href="#cb129-22"></a></span>
<span id="cb129-23"><a href="#cb129-23"></a><span class="kw">sourceCpp</span>(<span class="kw">paste0</span>(dir_cpp,<span class="st">&quot;Homework.cpp&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;C:/
## Users/63175/Desktop/StatComp20043/src/../inst/include&quot;: 系统找不到指定的路径。</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a>n&lt;-<span class="dv">4</span></span>
<span id="cb131-2"><a href="#cb131-2"></a>N&lt;-<span class="dv">2000</span></span>
<span id="cb131-3"><a href="#cb131-3"></a>sigma&lt;-<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">16</span>)</span>
<span id="cb131-4"><a href="#cb131-4"></a></span>
<span id="cb131-5"><a href="#cb131-5"></a>x0&lt;-<span class="dv">25</span></span>
<span id="cb131-6"><a href="#cb131-6"></a>rw1c&lt;-<span class="kw">MetropolisC</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb131-7"><a href="#cb131-7"></a>rw2c&lt;-<span class="kw">MetropolisC</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb131-8"><a href="#cb131-8"></a>rw3c&lt;-<span class="kw">MetropolisC</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb131-9"><a href="#cb131-9"></a>rw4c&lt;-<span class="kw">MetropolisC</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb131-10"><a href="#cb131-10"></a>rw1&lt;-<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb131-11"><a href="#cb131-11"></a>rw2&lt;-<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb131-12"><a href="#cb131-12"></a>rw3&lt;-<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb131-13"><a href="#cb131-13"></a>rw4&lt;-<span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span></code></pre></div>
<p>Compare the corresponding generated random numbers with those by R function:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a><span class="kw">plot</span>(rw1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma<span class="op">==</span><span class="fl">0.05</span>),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="st">&quot;R function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAn1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZjpmZrZmkLZmkNtmtttmtv+QOgCQttuQ29uQ2/+2ZgC2Zjq2Zma2ZpC2kDq227a229u22/+2/9u2///bkDrbtmbbtpDb2//b////tmb/25D/27b//7b//9v///9+dAEEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKT0lEQVR4nO2dDbvbphmGSZqc021dMntZuzani7N2zeK1sePD//9tkwRIyHw8IKEPy8/d6zq1ZfSC7iBAMkZCkihi6QKsHQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAiwiKDnJ9Hw4rtP7aaPj0K8Tdr5l891gNdfpiufzaKCKkUf9KZT/W6XsO/Xdy/vSZB40JuOnas4B1EJmpGlBDUV4PxoKsJBVSd19Jd9XZcqZf/6KMQr5e1/fxbim590wpf/1QF+/0e19Z/1q37qgiwqqDrcmCDrLDyo17u+IJ3EeplaD9NZSQ3Sp9iVoFef6r+7poX625ev+/rTJokKoHZXKezURVm6DTLH4xX0vnH4YLYf3/wmbUG6OWr+Z6cuysKCHkxf5BNUb6leP/Q6rU6Q2doktFKXZVFBr35uN9mCqnrgCGqPuxNkbJzqyrM5QVUF+FVYgxkk6O5qkO552sNRB6j+nsSVIC3u9N3PkTZog4LqPvu93mQEVWq+PjmCKmVv6xpjziVfL7ZFQdURmmGxOsBqQ9u59Q750I67T6Fx0BYF1cetD0hfapzfCfHmP9e9mNQj6R/rfevx8m/2SPrHbv+tCLolKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAQoLEjcDEsJKhtuOigIQEGAdQlaoTYKAqxMkNAfrMfUqgR13er43EqVl4JKxaGgmTKMhVOCRJHctilIKkGihKBCBV6boPa/sRluSJCwXuk6JO5WkO8iWfRetZ/fpyBfuMkEFWntNyxIbEiQ6Dbm36kKZEBBIAMtaHSc4glzw4krQbKcILENQY2TdqMw4+nRB6YHDLcuSFwJMv3PyANrR+QbFjQqR1FsRF48YV44YQnq9fcUpP9vGorrQxl5ySrkxgQ5V19G0MB8NyXIGBLXScYJktsQJJGgQRmLDQmSMUFDu2lh4o4fLxRPmBcuLsjcG8oPvz1BbqfVXnQMyNsMrG5ekIgIsu58ZGe+NUESCcpsbMWVoHEDqsIJc8J1DUxMkGeUhKJf3dK9HUFXd3ugILshyihBL+1NCboO1/uHdgTJLEHC+3JDgpwc2nYq7Q5aUNCo614KSo9aKGFWOOFu8qQ1dxnjpYgJipc+MWqcHEGXfb12b7OQYWhR8BxBshUUPVArZD8ZNLSMoGO9gOFl/96fZApBSs2tCNJqjoE197MF4VGxTnArgs6PjaBT4CTzhIMHnyxI5AlKOXEx09Sg1Bx0tYjOP9ODJY8g0JFZo9W8Ug1LKJuVUoVafFU11yPDmV26bz+8ewcFoZ5+fkGycfTiQ9WRhZbWHynIVwEtQd7PwnGXEDRBuLggc2/bKyN6T8kSlHniD0s4Wbj+Na7bEJvtAwS1Y/YRBR0o6Jjei8ESDBfkuRK2d5ULCioZzhZ0bYGCZCdISLeh0ZdqEUHBHLtWvbCgf495+NJQQe2AqHXVfqQ/CdSWoCBhC/KpTS1d8/fyg3l/fsRPp9Kj6XC4POxL+r4gYZ0mwWFkpCQFBe31U5WiT+9SA0VFP1m3PTXfXhFigrpE/p1TBHn2zT3F1MNh0LOD9ACxdA2SshMkMwUFc+wLckcIGaVTnMSL7+HTuS77+hqssCCzX0+Qrk44HhbkvfE9oJG2nzAU5lA5nEGQsM43vGcsYjFBx7oGJTw+8Ch2EwtqLytGCLLvHwlfpFxB6pEm6sFegPPjN1MIModkXXeNEWTGT9JczQ0taE4vpqnOxckEya5HLCnIc6ckvWQ1eeMgGG7AfmIKQdb93LGnmEVsJF0/jkndUSx3sar2s6+9hQjc/0nPcUpBEY7ViXjZ131daUG9uzfmiEoIcucix3ZLju/n+WnX/K2ferZuQWIZQebbsMPrL1MKkoUFeZNNWIMqDg/lBclrQakXdr5UliDhTzVRG6S1XPah0UABQdYAOHFPz7aFBFW9mDrJnp9KC/Icwi0KmjJcOUHmayIKCmRp3yWhoLgguSFBTqiigq6TzSxo1C3XYMzEdL7CuFGWFTRJuCKCJAW5dzIoqJ/MbX8pqJcs3kFdXcG0d50Kl2KhcIPy9JeBgkAZ9HRRU+HuSlBS80JBoAx3LCitgzKTsikoLijQ6ycHHwsFzRtuSKaBIghxx4J6uVKQm2maIHnfgtqcKcjNNEWQ7E8DvUNBqG7csSC5fkFT3HLNyV4mCJL9e9U5sQuypCChX4STURAFhXPt5qXF07kvceyCUNC84TJy7X6EH0/nvsSx03l+Uv9OaOWFmekmDy8s6GimUQd/1bukIAlHGlMLameYZf1ufgY6QfEvrKcWZK3YkbHywgwIM298YUHrrUGJguxdkmPnFMTMwFtbG2T98mBZQe1vDgP1h4LmDpecrTC5U5A/29UJKj6RfByWoNQ9kkMPKc9s4ZKzhTdcnT2SQ2cXZs5w00FBgCkFnUT45+P3LuggxO781y/OMoEL35MewDSCDtUA8dDUnuClxs0whaCm3py/rQWFLlbzgpYds5QeAeUnV2vfPf8hwzUoL+jWBHXDw+AygXlBNyeo+dmzrPux4MoCWUG3J6hwUAoqk+6GBMGVF/KCbk4QXnkhL+jWBCWsvJAXdGuCElZe2B6DvtUIr7ywPQYNFMMrL2yP3F4MrLywPW7m/sRSUBCAggAUBKAgAAUBKAhAQQAKApQXFPte0X78TZsuvkOM858+lw7pUFzQqX60Tbh06lsjOx3YIcJl31zwlAzpUlqQuuI/BJfuNl+otenQDmFOer52wZAeSgtSi3GH74YcH67SoR2CnMROqSkX0kdxQeCL18NfqvZiZ6VL+aY2hNqraEiH0oLUqR9sANRTAw67Lh3YIZ5Z7aBsSIeZBelELz+XE1Q2pMPcp5hK9Pi+4ClWNKTD3I20SvTthyItqi2oUEiHmbt5VfbqwIr0yY2gsiEd5h4oNsWuWtQiozrdi5UM6VD+UuMYH+Yf2m+vTTqwQwR9ipUM6cCLVQAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIcAOCenN6zZtu7u/ErF9Qb6pG+6ad+zs1qxfUm+zTvSk0fwyzekG96WLdm+MMZ1fDWgQ9f3xsFoZylt3pTTjs3pi5v5OzFkGH15/k+QfPqk29Kavtm3bu7+SsRJCuGm/Vu4NeZ6z5gYpXkEo3R0O0EkHqUC9/d7umwCmmPnuML/RUgnUJ2rsHHGik1Wcz9PUrEaTUmBphn2L+br6d+zt5yVYiqGpXflIL73g+8Q0U27m/U7MWQfL3d0K88a49qOf0Pj89SGuCbzv3d2JWI2itUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgP8DVe41f3eTFBMAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="kw">plot</span>(rw1c,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma<span class="op">==</span><span class="fl">0.05</span>),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Rcpp function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a><span class="kw">plot</span>(rw2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma<span class="op">==</span><span class="fl">0.5</span>),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="st">&quot;R function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="kw">plot</span>(rw2c,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma<span class="op">==</span><span class="fl">0.5</span>),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Rcpp function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a><span class="kw">plot</span>(rw3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma<span class="op">==</span><span class="dv">2</span>),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="st">&quot;R function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="kw">plot</span>(rw3c,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma<span class="op">==</span><span class="dv">2</span>),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Rcpp function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a><span class="kw">plot</span>(rw4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma<span class="op">==</span><span class="dv">16</span>),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="st">&quot;R function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="kw">plot</span>(rw4c,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma<span class="op">==</span><span class="dv">16</span>),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Rcpp function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> We can see that they are almost the same</p>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a>ts1 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw1R=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N),<span class="dt">rw1C=</span><span class="kw">MetropolisC</span>(sigma[<span class="dv">1</span>],x0,N))</span>
<span id="cb142-2"><a href="#cb142-2"></a><span class="kw">summary</span>(ts1)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr     lq  median      uq
## 1 rw1R 8259.3 8330.65 8879.85
## 2 rw1C  582.0  586.45  595.20</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a>ts2 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw2R=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N),<span class="dt">rw2C=</span><span class="kw">MetropolisC</span>(sigma[<span class="dv">2</span>],x0,N))</span>
<span id="cb144-2"><a href="#cb144-2"></a><span class="kw">summary</span>(ts2)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq  median      uq
## 1 rw2R 8314.50 8343.55 8450.75
## 2 rw2C  634.05  638.00  647.20</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a>ts3 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw3R=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N),<span class="dt">rw3C=</span><span class="kw">MetropolisC</span>(sigma[<span class="dv">3</span>],x0,N))</span>
<span id="cb146-2"><a href="#cb146-2"></a><span class="kw">summary</span>(ts3)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq  median      uq
## 1 rw3R 8339.45 8373.65 8420.25
## 2 rw3C  633.60  637.65  640.90</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a>ts4 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw4R=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N),<span class="dt">rw4C=</span><span class="kw">MetropolisC</span>(sigma[<span class="dv">4</span>],x0,N))</span>
<span id="cb148-2"><a href="#cb148-2"></a><span class="kw">summary</span>(ts4)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq median      uq
## 1 rw4R 8411.35 8455.8 8546.65
## 2 rw4C  612.95  617.8  625.65</code></pre>
<p>We can see that with each sigma, the Rcpp function runs much faster than the R function.</p>
<p>Hence we can conclude that Rcpp function can get the same result as R function and it runs faster. So we can use the Rcpp function if we can write the corresponding code to reduce the run time.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
